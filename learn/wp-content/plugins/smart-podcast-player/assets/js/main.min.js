/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

//     (c) 2010-2011 Jeremy Ashkenas, DocumentCloud Inc.

//     (c) 2011-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors

//     Backbone may be freely distributed under the MIT license.

// Copyright (c)2014 Derick Bailey, Muted Solutions, LLC.

// Distributed under MIT license

/*!
 * Includes BabySitter
 * https://github.com/marionettejs/backbone.babysitter/
 *
 * Includes Wreqr
 * https://github.com/marionettejs/backbone.wreqr/
 */

/** @license
 *
 * SoundManager 2: JavaScript Sound for the Web
 * ----------------------------------------------
 * http://schillmania.com/projects/soundmanager2/
 *
 * Copyright (c) 2007, Scott Schiller. All rights reserved.
 * Code provided under the BSD License:
 * http://schillmania.com/projects/soundmanager2/license.txt
 *
 * V2.97a.20131201
 */

/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*! Copyright (c) 2013 Brandon Aaron (http://brandon.aaron.sh)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Version: 3.1.9
 *
 * Requires: jQuery 1.2.2+
 */

/*!
 * jScrollPane - v2.0.19 - 2013-11-16
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2013 Kelvin Luck
 * Dual licensed under the MIT or GPL licenses.
 */

!function(){function e(e){var t=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi;return e.replace(t,"<a href='$1' target='_blank'>$1</a>")}function t(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}var n,i,r;!function(e){function t(e,t){return w.call(e,t)}function a(e,t){var n,i,r,a,s,o,l,u,p,c,d,h=t&&t.split("/"),f=y.map,m=f&&f["*"]||{};if(e&&"."===e.charAt(0))if(t){for(e=e.split("/"),s=e.length-1,y.nodeIdCompat&&k.test(e[s])&&(e[s]=e[s].replace(k,"")),e=h.slice(0,h.length-1).concat(e),p=0;p<e.length;p+=1)if(d=e[p],"."===d)e.splice(p,1),p-=1;else if(".."===d){if(1===p&&(".."===e[2]||".."===e[0]))break;p>0&&(e.splice(p-1,2),p-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((h||m)&&f){for(n=e.split("/"),p=n.length;p>0;p-=1){if(i=n.slice(0,p).join("/"),h)for(c=h.length;c>0;c-=1)if(r=f[h.slice(0,c).join("/")],r&&(r=r[i])){a=r,o=p;break}if(a)break;!l&&m&&m[i]&&(l=m[i],u=p)}!a&&l&&(a=l,o=u),a&&(n.splice(0,o,a),e=n.join("/"))}return e}function s(t,n){return function(){var i=b.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),h.apply(e,i.concat([t,n]))}}function o(e){return function(t){return a(t,e)}}function l(e){return function(t){g[e]=t}}function u(n){if(t(v,n)){var i=v[n];delete v[n],_[n]=!0,d.apply(e,i)}if(!t(g,n)&&!t(_,n))throw new Error("No "+n);return g[n]}function p(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function c(e){return function(){return y&&y.config&&y.config[e]||{}}}var d,h,f,m,g={},v={},y={},_={},w=Object.prototype.hasOwnProperty,b=[].slice,k=/\.js$/;f=function(e,t){var n,i=p(e),r=i[0];return e=i[1],r&&(r=a(r,t),n=u(r)),r?e=n&&n.normalize?n.normalize(e,o(t)):a(e,t):(e=a(e,t),i=p(e),r=i[0],e=i[1],r&&(n=u(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},m={require:function(e){return s(e)},exports:function(e){var t=g[e];return"undefined"!=typeof t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:c(e)}}},d=function(n,i,r,a){var o,p,c,d,h,y,w=[],b=typeof r;if(a=a||n,"undefined"===b||"function"===b){for(i=!i.length&&r.length?["require","exports","module"]:i,h=0;h<i.length;h+=1)if(d=f(i[h],a),p=d.f,"require"===p)w[h]=m.require(n);else if("exports"===p)w[h]=m.exports(n),y=!0;else if("module"===p)o=w[h]=m.module(n);else if(t(g,p)||t(v,p)||t(_,p))w[h]=u(p);else{if(!d.p)throw new Error(n+" missing "+p);d.p.load(d.n,s(a,!0),l(p),{}),w[h]=g[p]}c=r?r.apply(g[n],w):void 0,n&&(o&&o.exports!==e&&o.exports!==g[n]?g[n]=o.exports:c===e&&y||(g[n]=c))}else n&&(g[n]=r)},n=i=h=function(t,n,i,r,a){if("string"==typeof t)return m[t]?m[t](n):u(f(t,n).f);if(!t.splice){if(y=t,y.deps&&h(y.deps,y.callback),!n)return;n.splice?(t=n,n=i,i=null):t=e}return n=n||function(){},"function"==typeof i&&(i=r,r=a),r?d(e,t,n,i):setTimeout(function(){d(e,t,n,i)},4),h},h.config=function(e){return h(e)},n._defined=g,r=function(e,n,i){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");n.splice||(i=n,n=[]),t(g,e)||t(v,e)||(v[e]=[e,n,i])},r.amd={jQuery:!0}}(),r("vendor/almond",function(){}),function(e,t){"undefined"!=typeof exports?t(e,exports,i("underscore")):"function"==typeof r&&r.amd?r("backbone",["underscore","jquery","exports"],function(n,i,r){e.Backbone=t(e,r,n,i)}):e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,i){{var r=e.Backbone,a=[],s=(a.push,a.slice);a.splice}t.VERSION="1.1.0",t.$=i,t.noConflict=function(){return e.Backbone=r,this},t.emulateHTTP=!1,t.emulateJSON=!1;var o=t.Events={on:function(e,t,n){if(!u(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var i=this._events[e]||(this._events[e]=[]);return i.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,i){if(!u(this,"once",e,[t,i])||!t)return this;var r=this,a=n.once(function(){r.off(e,a),t.apply(this,arguments)});return a._callback=t,this.on(e,a,i)},off:function(e,t,i){var r,a,s,o,l,p,c,d;if(!this._events||!u(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events={},this;for(o=e?[e]:n.keys(this._events),l=0,p=o.length;p>l;l++)if(e=o[l],s=this._events[e]){if(this._events[e]=r=[],t||i)for(c=0,d=s.length;d>c;c++)a=s[c],(t&&t!==a.callback&&t!==a.callback._callback||i&&i!==a.context)&&r.push(a);r.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=s.call(arguments,1);if(!u(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&p(n,t),i&&p(i,arguments),this},stopListening:function(e,t,i){var r=this._listeningTo;if(!r)return this;var a=!t&&!i;i||"object"!=typeof t||(i=this),e&&((r={})[e._listenId]=e);for(var s in r)e=r[s],e.off(t,i,this),(a||n.isEmpty(e._events))&&delete this._listeningTo[s];return this}},l=/\s+/,u=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)e[t].apply(e,[r,n[r]].concat(i));return!1}if(l.test(n)){for(var a=n.split(l),s=0,o=a.length;o>s;s++)e[t].apply(e,[a[s]].concat(i));return!1}return!0},p=function(e,t){var n,i=-1,r=e.length,a=t[0],s=t[1],o=t[2];switch(t.length){case 0:for(;++i<r;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=e[i]).callback.call(n.ctx,a);return;case 2:for(;++i<r;)(n=e[i]).callback.call(n.ctx,a,s);return;case 3:for(;++i<r;)(n=e[i]).callback.call(n.ctx,a,s,o);return;default:for(;++i<r;)(n=e[i]).callback.apply(n.ctx,t)}},c={listenTo:"on",listenToOnce:"once"};n.each(c,function(e,t){o[t]=function(t,i,r){var a=this._listeningTo||(this._listeningTo={}),s=t._listenId||(t._listenId=n.uniqueId("l"));return a[s]=t,r||"object"!=typeof i||(r=this),t[e](i,r,this),this}}),o.bind=o.on,o.unbind=o.off,n.extend(t,o);var d=t.Model=function(e,t){var i=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(d.prototype,o,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var r,a,s,o,l,u,p,c;if(null==e)return this;if("object"==typeof e?(a=e,i=t):(a={})[e]=t,i||(i={}),!this._validate(a,i))return!1;s=i.unset,l=i.silent,o=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=n.clone(this.attributes),this.changed={}),c=this.attributes,p=this._previousAttributes,this.idAttribute in a&&(this.id=a[this.idAttribute]);for(r in a)t=a[r],n.isEqual(c[r],t)||o.push(r),n.isEqual(p[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete c[r]:c[r]=t;if(!l){o.length&&(this._pending=!0);for(var d=0,h=o.length;h>d;d++)this.trigger("change:"+o[d],this,c[o[d]],i)}if(u)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,i=!1,r=this._changing?this._previousAttributes:this.attributes;for(var a in e)n.isEqual(r[a],t=e[a])||((i||(i={}))[a]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return t.set(t.parse(n,e),e)?(i&&i(t,n,e),void t.trigger("sync",t,n,e)):!1},H(this,e),this.sync("read",this,e)},save:function(e,t,i){var r,a,s,o=this.attributes;if(null==e||"object"==typeof e?(r=e,i=t):(r={})[e]=t,i=n.extend({validate:!0},i),r&&!i.wait){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;r&&i.wait&&(this.attributes=n.extend({},o,r)),void 0===i.parse&&(i.parse=!0);var l=this,u=i.success;return i.success=function(e){l.attributes=o;var t=l.parse(e,i);return i.wait&&(t=n.extend(r||{},t)),n.isObject(t)&&!l.set(t,i)?!1:(u&&u(l,e,i),void l.trigger("sync",l,e,i))},H(this,i),a=this.isNew()?"create":i.patch?"patch":"update","patch"===a&&(i.attrs=r),s=this.sync(a,this,i),r&&i.wait&&(this.attributes=o),s},destroy:function(e){e=e?n.clone(e):{};var t=this,i=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(n){(e.wait||t.isNew())&&r(),i&&i(t,n,e),t.isNew()||t.trigger("sync",t,n,e)},this.isNew())return e.success(),!1;H(this,e);var a=this.sync("delete",this,e);return e.wait||r(),a},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||L();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,n.extend(t,{validationError:i})),!1):!0}});var h=["keys","values","pairs","invert","pick","omit"];n.each(h,function(e){d.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var f=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},m={add:!0,remove:!0,merge:!0},g={add:!0,remove:!1};n.extend(f.prototype,o,{model:d,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,g))},remove:function(e,t){var i=!n.isArray(e);e=i?[e]:n.clone(e),t||(t={});var r,a,s,o;for(r=0,a=e.length;a>r;r++)o=e[r]=this.get(e[r]),o&&(delete this._byId[o.id],delete this._byId[o.cid],s=this.indexOf(o),this.models.splice(s,1),this.length--,t.silent||(t.index=s,o.trigger("remove",o,this,t)),this._removeReference(o));return i?e[0]:e},set:function(e,t){t=n.defaults({},t,m),t.parse&&(e=this.parse(e,t));var i=!n.isArray(e);e=i?e?[e]:[]:n.clone(e);var r,a,s,o,l,u,p,c=t.at,h=this.model,f=this.comparator&&null==c&&t.sort!==!1,g=n.isString(this.comparator)?this.comparator:null,v=[],y=[],_={},w=t.add,b=t.merge,k=t.remove,C=!f&&w&&k?[]:!1;for(r=0,a=e.length;a>r;r++){if(l=e[r],s=l instanceof d?o=l:l[h.prototype.idAttribute],u=this.get(s))k&&(_[u.cid]=!0),b&&(l=l===o?o.attributes:l,t.parse&&(l=u.parse(l,t)),u.set(l,t),f&&!p&&u.hasChanged(g)&&(p=!0)),e[r]=u;else if(w){if(o=e[r]=this._prepareModel(l,t),!o)continue;v.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,null!=o.id&&(this._byId[o.id]=o)}C&&C.push(u||o)}if(k){for(r=0,a=this.length;a>r;++r)_[(o=this.models[r]).cid]||y.push(o);y.length&&this.remove(y,t)}if(v.length||C&&C.length)if(f&&(p=!0),this.length+=v.length,null!=c)for(r=0,a=v.length;a>r;r++)this.models.splice(c+r,0,v[r]);else{C&&(this.models.length=0);var P=C||v;for(r=0,a=P.length;a>r;r++)this.models.push(P[r])}if(p&&this.sort({silent:!0}),!t.silent){for(r=0,a=v.length;a>r;r++)(o=v[r]).trigger("add",o,this,t);(p||C&&C.length)&&this.trigger("sort",this,t)}return i?e[0]:e},reset:function(e,t){t||(t={});for(var i=0,r=this.models.length;r>i;i++)this._removeReference(this.models[i]);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return s.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e.id]||this._byId[e.cid]||this._byId[e]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var r=e.reset?"reset":"set";i[r](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},H(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?n.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,r=t.success;return t.success=function(e,t,n){n.wait&&i.add(e,n),r&&r(e,t,n)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof d)return e.collection||(e.collection=this),e;t=t?n.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];n.each(v,function(e){f.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var y=["groupBy","countBy","sortBy"];n.each(y,function(e){f.prototype[e]=function(t,i){var r=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,r,i)}});var _=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,b)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,b=["model","collection","el","id","attributes","className","tagName","events"];n.extend(_.prototype,o,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(n.isFunction(i)||(i=this[e[t]]),i){var r=t.match(w),a=r[1],s=r[2];i=n.bind(i,this),a+=".delegateEvents"+this.cid,""===s?this.$el.on(a,i):this.$el.on(a,s,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var i=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,r){var a=C[e];n.defaults(r||(r={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:a,dataType:"json"};if(r.url||(s.url=n.result(i,"url")||L()),null!=r.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),r.emulateHTTP&&("PUT"===a||"DELETE"===a||"PATCH"===a)){s.type="POST",r.emulateJSON&&(s.data._method=a);var o=r.beforeSend;r.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",a),o?o.apply(this,arguments):void 0}}"GET"===s.type||r.emulateJSON||(s.processData=!1),"PATCH"===s.type&&k&&(s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=r.xhr=t.ajax(n.extend(s,r));return i.trigger("request",i,l,r),l};var k=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),C={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var P=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},M=/\((.*?)\)/g,T=/(\(\?)?:\w+/g,x=/\*\w+/g,O=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(P.prototype,o,{initialize:function(){},route:function(e,i,r){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var a=this;return t.history.route(e,function(n){var s=a._extractParameters(e,n);r&&r.apply(a,s),a.trigger.apply(a,["route:"+i].concat(s)),a.trigger("route",i,s),t.history.trigger("route",a,i,s)}),this},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(O,"\\$&").replace(M,"(?:$1)?").replace(T,function(e,t){return t?e:"([^/]+)"}).replace(x,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return n.map(i,function(e){return e?decodeURIComponent(e):null})}});var A=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},j=/^[#\/]|\s+$/g,I=/^\/+|\/+$/g,S=/msie [\w.]+/,E=/\/$/,R=/[?#].*$/;A.started=!1,n.extend(A.prototype,o,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(E,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(j,"")},start:function(e){if(A.started)throw new Error("Backbone.history has already been started");A.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),r=document.documentMode,a=S.exec(navigator.userAgent.toLowerCase())&&(!r||7>=r);this.root=("/"+this.root+"/").replace(I,"/"),a&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!a?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var s=this.location,o=s.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!o)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&o&&s.hash&&(this.fragment=this.getHash().replace(j,""),this.history.replaceState({},document.title,this.root+this.fragment+s.search))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),A.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!A.started)return!1;t&&t!==!0||(t={trigger:!!t});var n=this.root+(e=this.getFragment(e||""));if(e=e.replace(R,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new A;var $=function(e,t){var i,r=this;i=e&&n.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,t);var a=function(){this.constructor=i};return a.prototype=r.prototype,i.prototype=new a,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};d.extend=f.extend=P.extend=_.extend=A.extend=$;var L=function(){throw new Error('A "url" property or function must be specified')},H=function(e,t){var n=t.error;t.error=function(i){n&&n(e,i,t),e.trigger("error",e,i,t)}};return t}),function(e,t){if("object"==typeof exports){var n=i("underscore"),a=i("backbone");module.exports=t(n,a)}else"function"==typeof r&&r.amd&&r("backbone.wreqr",["underscore","backbone"],t)}(this,function(e,t){"use strict";return t.Wreqr=function(e,t,n){var i={};return i.Handlers=function(e,t){var n=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,n){var i=null;t.isObject(e)&&!t.isFunction(e)&&(i=e.context,e=e.callback),this.setHandler(n,e,i)},this)},setHandler:function(e,t,n){var i={callback:t,context:n};this._wreqrHandlers[e]=i,this.trigger("handler:add",e,t,n)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(!t)throw new Error("Handler not found for '"+e+"'");return function(){var e=Array.prototype.slice.apply(arguments);return t.callback.apply(t.context,e)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(e,n),i.CommandStorage=function(){var t=function(e){this.options=e,this._commands={},n.isFunction(this.initialize)&&this.initialize(e)};return n.extend(t.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){var n=this.getCommands(e);n.instances.push(t)},clearCommands:function(e){var t=this.getCommands(e);t.instances=[]}}),t}(),i.Commands=function(e){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var n=Array.prototype.slice.call(arguments);e.Handlers.prototype.constructor.apply(this,n)},execute:function(e,t){e=arguments[0],t=Array.prototype.slice.call(arguments,1),this.hasHandler(e)?this.getHandler(e).apply(this,t):this.storage.addCommand(e,t)},_executeCommands:function(e,t,i){var r=this.storage.getCommands(e);n.each(r.instances,function(e){t.apply(i,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var t,i=e.storageType||this.storageType;t=n.isFunction(i)?new i:i,this.storage=t}})}(i),i.RequestResponse=function(e){return e.Handlers.extend({request:function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);return this.getHandler(e).apply(this,t)}})}(i),i.EventAggregator=function(e,t){var n=function(){};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events),n}(e,n),i}(t,t.Marionette,e),t.Wreqr}),function(e,t){if("object"==typeof exports){var n=i("underscore"),a=i("backbone");module.exports=t(n,a)}else"function"==typeof r&&r.amd&&r("backbone.babysitter",["underscore","backbone"],t)}(this,function(e,t){"option strict";return t.ChildViewContainer=function(e,t){var n=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(n.prototype,{add:function(e,t){var n=e.cid;return this._views[n]=e,e.model&&(this._indexByModel[e.model.cid]=n),t&&(this._indexByCustom[t]=n),this._updateLength(),this},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var n=e.cid;return e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,function(e,t){return e===n?(delete this._indexByCustom[t],!0):void 0},this),delete this._views[n],this._updateLength(),this},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,n){t.each(this._views,function(i){t.isFunction(i[e])&&i[e].apply(i,n||[])})},_updateLength:function(){this.length=t.size(this._views)}});var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return t.each(i,function(e){n.prototype[e]=function(){var n=t.values(this._views),i=[n].concat(t.toArray(arguments));return t[e].apply(t,i)}}),n}(t,e),t.ChildViewContainer}),function(e,t){if("object"==typeof exports){var n=i("underscore"),a=i("backbone"),s=i("backbone.wreqr"),o=i("backbone.babysitter");module.exports=t(n,a,s,o)}else"function"==typeof r&&r.amd&&r("marionette",["underscore","backbone","backbone.wreqr","backbone.babysitter"],t)}(this,function(e,t){!function(e,t,n){"use strict";function i(e){return s.call(e)}function r(e,t){var n=new Error(e);throw n.name=t||"Error",n}var a={};t.Marionette=a,a.$=t.$;var s=Array.prototype.slice;return a.extend=t.Model.extend,a.getOption=function(e,t){if(e&&t){var n;return n=e.options&&t in e.options&&void 0!==e.options[t]?e.options[t]:e[t]}},a.normalizeMethods=function(e){var t,i={};return n.each(e,function(e,r){t=e,n.isFunction(t)||(t=this[t]),t&&(i[r]=t)},this),i},a.triggerMethod=function(){function e(e,t,n){return n.toUpperCase()}var t=/(^|:)(\w)/gi,i=function(i){var r="on"+i.replace(t,e),a=this[r];return n.isFunction(this.trigger)&&this.trigger.apply(this,arguments),n.isFunction(a)?a.apply(this,n.tail(arguments)):void 0};return i}(),a.MonitorDOMRefresh=function(e){function t(e){e._isShown=!0,r(e)}function i(e){e._isRendered=!0,r(e)}function r(e){e._isShown&&e._isRendered&&a(e)&&n.isFunction(e.triggerMethod)&&e.triggerMethod("dom:refresh")}function a(t){return e.contains(t.el)}return function(e){e.listenTo(e,"show",function(){t(e)}),e.listenTo(e,"render",function(){i(e)})}}(document.documentElement),function(e){function t(e,t,i,a){var s=a.split(/\s+/);n.each(s,function(n){var a=e[n];a||r("Method '"+n+"' was configured as an event handler, but does not exist."),e.listenTo(t,i,a,e)})}function i(e,t,n,i){e.listenTo(t,n,i,e)}function a(e,t,i,r){var a=r.split(/\s+/);n.each(a,function(n){var r=e[n];e.stopListening(t,i,r,e)})}function s(e,t,n,i){e.stopListening(t,n,i,e)}function o(e,t,i,r,a){t&&i&&(n.isFunction(i)&&(i=i.call(e)),n.each(i,function(i,s){n.isFunction(i)?r(e,t,s,i):a(e,t,s,i)}))}e.bindEntityEvents=function(e,n,r){o(e,n,r,i,t)},e.unbindEntityEvents=function(e,t,n){o(e,t,n,s,a)}}(a),a.Callbacks=function(){this._deferred=a.$.Deferred(),this._callbacks=[]},n.extend(a.Callbacks.prototype,{add:function(e,t){this._callbacks.push({cb:e,ctx:t}),this._deferred.done(function(n,i){t&&(n=t),e.call(n,i)})},run:function(e,t){this._deferred.resolve(t,e)},reset:function(){var e=this._callbacks;this._deferred=a.$.Deferred(),this._callbacks=[],n.each(e,function(e){this.add(e.cb,e.ctx)},this)}}),a.Controller=function(e){this.triggerMethod=a.triggerMethod,this.options=e||{},n.isFunction(this.initialize)&&this.initialize(this.options)},a.Controller.extend=a.extend,n.extend(a.Controller.prototype,t.Events,{close:function(){this.stopListening(),this.triggerMethod("close"),this.unbind()}}),a.Region=function(e){if(this.options=e||{},this.el=a.getOption(this,"el"),!this.el){var t=new Error("An 'el' must be specified for a region.");throw t.name="NoElError",t}if(this.initialize){var n=Array.prototype.slice.apply(arguments);this.initialize.apply(this,n)}},n.extend(a.Region,{buildRegion:function(e,t){var i="string"==typeof e,r="string"==typeof e.selector,a="undefined"==typeof e.regionType,s="function"==typeof e;if(!s&&!i&&!r)throw new Error("Region must be specified as a Region type, a selector string or an object with selector property");var o,l;i&&(o=e),e.selector&&(o=e.selector,delete e.selector),s&&(l=e),!s&&a&&(l=t),e.regionType&&(l=e.regionType,delete e.regionType),(i||s)&&(e={}),e.el=o;var u=new l(e);return e.parentEl&&(u.getEl=function(t){var i=e.parentEl;return n.isFunction(i)&&(i=i()),i.find(t)}),u}}),n.extend(a.Region.prototype,t.Events,{show:function(e){this.ensureEl();var t=e.isClosed||n.isUndefined(e.$el),i=e!==this.currentView;i&&this.close(),e.render(),(i||t)&&this.open(e),this.currentView=e,a.triggerMethod.call(this,"show",e),a.triggerMethod.call(e,"show")},ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=this.getEl(this.el))},getEl:function(e){return a.$(e)},open:function(e){this.$el.empty().append(e.el)},close:function(){var e=this.currentView;e&&!e.isClosed&&(e.close?e.close():e.remove&&e.remove(),a.triggerMethod.call(this,"close",e),delete this.currentView)},attachView:function(e){this.currentView=e},reset:function(){this.close(),delete this.$el}}),a.Region.extend=a.extend,a.RegionManager=function(e){var t=e.Controller.extend({constructor:function(t){this._regions={},e.Controller.prototype.constructor.call(this,t)},addRegions:function(e,t){var i={};return n.each(e,function(e,r){"string"==typeof e&&(e={selector:e}),e.selector&&(e=n.defaults({},e,t));var a=this.addRegion(r,e);i[r]=a},this),i},addRegion:function(t,i){var r,a=n.isObject(i),s=n.isString(i),o=!!i.selector;return r=s||a&&o?e.Region.buildRegion(i,e.Region):n.isFunction(i)?e.Region.buildRegion(i,e.Region):i,this._store(t,r),this.triggerMethod("region:add",t,r),r},get:function(e){return this._regions[e]},removeRegion:function(e){var t=this._regions[e];this._remove(e,t)},removeRegions:function(){n.each(this._regions,function(e,t){this._remove(t,e)},this)},closeRegions:function(){n.each(this._regions,function(e){e.close()},this)},close:function(){this.removeRegions();var t=Array.prototype.slice.call(arguments);e.Controller.prototype.close.apply(this,t)},_store:function(e,t){this._regions[e]=t,this._setLength()},_remove:function(e,t){t.close(),delete this._regions[e],this._setLength(),this.triggerMethod("region:remove",e,t)},_setLength:function(){this.length=n.size(this._regions)}}),i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return n.each(i,function(e){t.prototype[e]=function(){var t=n.values(this._regions),i=[t].concat(n.toArray(arguments));
return n[e].apply(n,i)}}),t}(a),a.TemplateCache=function(e){this.templateId=e},n.extend(a.TemplateCache,{templateCaches:{},get:function(e){var t=this.templateCaches[e];return t||(t=new a.TemplateCache(e),this.templateCaches[e]=t),t.load()},clear:function(){var e,t=i(arguments),n=t.length;if(n>0)for(e=0;n>e;e++)delete this.templateCaches[t[e]];else this.templateCaches={}}}),n.extend(a.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var e=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(e),this.compiledTemplate},loadTemplate:function(e){var t=a.$(e).html();return t&&0!==t.length||r("Could not find template: '"+e+"'","NoTemplateError"),t},compileTemplate:function(e){return n.template(e)}}),a.Renderer={render:function(e,t){if(!e){var n=new Error("Cannot render the template since it's false, null or undefined.");throw n.name="TemplateNotFoundError",n}var i;return(i="function"==typeof e?e:a.TemplateCache.get(e))(t)}},a.View=t.View.extend({constructor:function(e){n.bindAll(this,"render");var i=Array.prototype.slice.apply(arguments);this.options=n.extend({},n.result(this,"options"),n.isFunction(e)?e.call(this):e),this.events=this.normalizeUIKeys(n.result(this,"events")),t.View.prototype.constructor.apply(this,i),a.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:a.triggerMethod,normalizeMethods:a.normalizeMethods,getTemplate:function(){return a.getOption(this,"template")},mixinTemplateHelpers:function(e){e=e||{};var t=a.getOption(this,"templateHelpers");return n.isFunction(t)&&(t=t.call(this)),n.extend(e,t)},normalizeUIKeys:function(e){return"undefined"!=typeof e?(n.each(n.keys(e),function(t){var n=t.split("@ui.");2===n.length&&(e[n[0]+this.ui[n[1]]]=e[t],delete e[t])},this),e):void 0},configureTriggers:function(){if(this.triggers){var e={},t=this.normalizeUIKeys(n.result(this,"triggers"));return n.each(t,function(t,i){var r=n.isObject(t),a=r?t.event:t;e[i]=function(e){if(e){var n=e.preventDefault,i=e.stopPropagation,s=r?t.preventDefault:n,o=r?t.stopPropagation:i;s&&n&&n.apply(e),o&&i&&i.apply(e)}var l={view:this,model:this.model,collection:this.collection};this.triggerMethod(a,l)}},this),e}},delegateEvents:function(e){this._delegateDOMEvents(e),a.bindEntityEvents(this,this.model,a.getOption(this,"modelEvents")),a.bindEntityEvents(this,this.collection,a.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(e){e=e||this.events,n.isFunction(e)&&(e=e.call(this));var i={},r=this.configureTriggers();n.extend(i,e,r),t.View.prototype.delegateEvents.call(this,i)},undelegateEvents:function(){var e=Array.prototype.slice.call(arguments);t.View.prototype.undelegateEvents.apply(this,e),a.unbindEntityEvents(this,this.model,a.getOption(this,"modelEvents")),a.unbindEntityEvents(this,this.collection,a.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(!this.isClosed){var e=this.triggerMethod("before:close");e!==!1&&(this.isClosed=!0,this.triggerMethod("close"),this.unbindUIElements(),this.remove())}},bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var e=n.result(this,"_uiBindings");this.ui={},n.each(n.keys(e),function(t){var n=e[t];this.ui[t]=this.$(n)},this)}},unbindUIElements:function(){this.ui&&this._uiBindings&&(n.each(this.ui,function(e,t){delete this.ui[t]},this),this.ui=this._uiBindings,delete this._uiBindings)}}),a.ItemView=a.View.extend({constructor:function(){a.View.prototype.constructor.apply(this,i(arguments))},serializeData:function(){var e={};return this.model?e=this.model.toJSON():this.collection&&(e={items:this.collection.toJSON()}),e},render:function(){this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this);var e=this.serializeData();e=this.mixinTemplateHelpers(e);var t=this.getTemplate(),n=a.Renderer.render(t,e);return this.$el.html(n),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this},close:function(){this.isClosed||(this.triggerMethod("item:before:close"),a.View.prototype.close.apply(this,i(arguments)),this.triggerMethod("item:closed"))}}),a.CollectionView=a.View.extend({itemViewEventPrefix:"itemview",constructor:function(){this._initChildViewStorage(),a.View.prototype.constructor.apply(this,i(arguments)),this._initialEvents(),this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment(),this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){this.isBuffering=!1,this.appendBuffer(this,this.elBuffer),this._triggerShowBufferedChildren(),this.initRenderBuffer()},_triggerShowBufferedChildren:function(){this._isShown&&(n.each(this._bufferedChildren,function(e){a.triggerMethod.call(e,"show")}),this._bufferedChildren=[])},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this.render,this))},addChildView:function(e){this.closeEmptyView();var t=this.getItemView(e),n=this.collection.indexOf(e);this.addItemView(e,t,n)},onShowCalled:function(){this.children.each(function(e){a.triggerMethod.call(e,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this),this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this),this.triggerMethod("collection:rendered",this)},render:function(){return this.isClosed=!1,this.triggerBeforeRender(),this._renderChildren(),this.triggerRendered(),this},_renderChildren:function(){this.startBuffering(),this.closeEmptyView(),this.closeChildren(),this.isEmpty(this.collection)?this.showEmptyView():this.showCollection(),this.endBuffering()},showCollection:function(){var e;this.collection.each(function(t,n){e=this.getItemView(t),this.addItemView(t,e,n)},this)},showEmptyView:function(){var e=this.getEmptyView();if(e&&!this._showingEmptyView){this._showingEmptyView=!0;var n=new t.Model;this.addItemView(n,e,0)}},closeEmptyView:function(){this._showingEmptyView&&(this.closeChildren(),delete this._showingEmptyView)},getEmptyView:function(){return a.getOption(this,"emptyView")},getItemView:function(){var e=a.getOption(this,"itemView");return e||r("An `itemView` must be specified","NoItemViewError"),e},addItemView:function(e,t,i){var r=a.getOption(this,"itemViewOptions");n.isFunction(r)&&(r=r.call(this,e,i));var s=this.buildItemView(e,t,r);return this.addChildViewEventForwarding(s),this.triggerMethod("before:item:added",s),this.children.add(s),this.renderItemView(s,i),this._isShown&&!this.isBuffering&&a.triggerMethod.call(s,"show"),this.triggerMethod("after:item:added",s),s},addChildViewEventForwarding:function(e){var t=a.getOption(this,"itemViewEventPrefix");this.listenTo(e,"all",function(){var r=i(arguments),s=r[0],o=this.normalizeMethods(this.getItemEvents());r[0]=t+":"+s,r.splice(1,0,e),"undefined"!=typeof o&&n.isFunction(o[s])&&o[s].apply(this,r),a.triggerMethod.apply(this,r)},this)},getItemEvents:function(){return n.isFunction(this.itemEvents)?this.itemEvents.call(this):this.itemEvents},renderItemView:function(e,t){e.render(),this.appendHtml(this,e,t)},buildItemView:function(e,t,i){var r=n.extend({model:e},i);return new t(r)},removeItemView:function(e){var t=this.children.findByModel(e);this.removeChildView(t),this.checkEmpty()},removeChildView:function(e){e&&(this.stopListening(e),e.close?e.close():e.remove&&e.remove(),this.children.remove(e)),this.triggerMethod("item:removed",e)},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},appendBuffer:function(e,t){e.$el.append(t)},appendHtml:function(e,t){e.isBuffering?(e.elBuffer.appendChild(t.el),e._bufferedChildren.push(t)):e.$el.append(t.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},close:function(){this.isClosed||(this.triggerMethod("collection:before:close"),this.closeChildren(),this.triggerMethod("collection:closed"),a.View.prototype.close.apply(this,i(arguments)))},closeChildren:function(){this.children.each(function(e){this.removeChildView(e)},this),this.checkEmpty()}}),a.CompositeView=a.CollectionView.extend({constructor:function(){a.CollectionView.prototype.constructor.apply(this,i(arguments))},_initialEvents:function(){this.once("render",function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this._renderChildren,this))})},getItemView:function(){var e=a.getOption(this,"itemView")||this.constructor;return e||r("An `itemView` must be specified","NoItemViewError"),e},serializeData:function(){var e={};return this.model&&(e=this.model.toJSON()),e},render:function(){this.isRendered=!0,this.isClosed=!1,this.resetItemViewContainer(),this.triggerBeforeRender();var e=this.renderModel();return this.$el.html(e),this.bindUIElements(),this.triggerMethod("composite:model:rendered"),this._renderChildren(),this.triggerMethod("composite:rendered"),this.triggerRendered(),this},_renderChildren:function(){this.isRendered&&(this.triggerMethod("composite:collection:before:render"),a.CollectionView.prototype._renderChildren.call(this),this.triggerMethod("composite:collection:rendered"))},renderModel:function(){var e={};e=this.serializeData(),e=this.mixinTemplateHelpers(e);var t=this.getTemplate();return a.Renderer.render(t,e)},appendBuffer:function(e,t){var n=this.getItemViewContainer(e);n.append(t)},appendHtml:function(e,t){if(e.isBuffering)e.elBuffer.appendChild(t.el),e._bufferedChildren.push(t);else{var n=this.getItemViewContainer(e);n.append(t.el)}},getItemViewContainer:function(e){if("$itemViewContainer"in e)return e.$itemViewContainer;var t,i=a.getOption(e,"itemViewContainer");if(i){var s=n.isFunction(i)?i.call(this):i;t=e.$(s),t.length<=0&&r("The specified `itemViewContainer` was not found: "+e.itemViewContainer,"ItemViewContainerMissingError")}else t=e.$el;return e.$itemViewContainer=t,t},resetItemViewContainer:function(){this.$itemViewContainer&&delete this.$itemViewContainer}}),a.Layout=a.ItemView.extend({regionType:a.Region,constructor:function(e){e=e||{},this._firstRender=!0,this._initializeRegions(e),a.ItemView.prototype.constructor.call(this,e)},render:function(){this.isClosed&&this._initializeRegions(),this._firstRender?this._firstRender=!1:this.isClosed||this._reInitializeRegions();var e=Array.prototype.slice.apply(arguments),t=a.ItemView.prototype.render.apply(this,e);return t},close:function(){if(!this.isClosed){this.regionManager.close();var e=Array.prototype.slice.apply(arguments);a.ItemView.prototype.close.apply(this,e)}},addRegion:function(e,t){var n={};return n[e]=t,this._buildRegions(n)[e]},addRegions:function(e){return this.regions=n.extend({},this.regions,e),this._buildRegions(e)},removeRegion:function(e){return delete this.regions[e],this.regionManager.removeRegion(e)},_buildRegions:function(e){var t=this,n={regionType:a.getOption(this,"regionType"),parentEl:function(){return t.$el}};return this.regionManager.addRegions(e,n)},_initializeRegions:function(e){var t;this._initRegionManager(),t=n.isFunction(this.regions)?this.regions(e):this.regions||{},this.addRegions(t)},_reInitializeRegions:function(){this.regionManager.closeRegions(),this.regionManager.each(function(e){e.reset()})},_initRegionManager:function(){this.regionManager=new a.RegionManager,this.listenTo(this.regionManager,"region:add",function(e,t){this[e]=t,this.trigger("region:add",e,t)}),this.listenTo(this.regionManager,"region:remove",function(e,t){delete this[e],this.trigger("region:remove",e,t)})}}),a.AppRouter=t.Router.extend({constructor:function(e){t.Router.prototype.constructor.apply(this,i(arguments)),this.options=e||{};var n=a.getOption(this,"appRoutes"),r=this._getController();this.processAppRoutes(r,n)},appRoute:function(e,t){var n=this._getController();this._addAppRoute(n,e,t)},processAppRoutes:function(e,t){if(t){var i=n.keys(t).reverse();n.each(i,function(n){this._addAppRoute(e,n,t[n])},this)}},_getController:function(){return a.getOption(this,"controller")},_addAppRoute:function(e,t,i){var r=e[i];if(!r)throw new Error("Method '"+i+"' was not found on the controller");this.route(t,i,n.bind(r,e))}}),a.Application=function(e){this._initRegionManager(),this._initCallbacks=new a.Callbacks,this.vent=new t.Wreqr.EventAggregator,this.commands=new t.Wreqr.Commands,this.reqres=new t.Wreqr.RequestResponse,this.submodules={},n.extend(this,e),this.triggerMethod=a.triggerMethod},n.extend(a.Application.prototype,t.Events,{execute:function(){var e=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,e)},request:function(){var e=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,e)},addInitializer:function(e){this._initCallbacks.add(e)},start:function(e){this.triggerMethod("initialize:before",e),this._initCallbacks.run(e,this),this.triggerMethod("initialize:after",e),this.triggerMethod("start",e)},addRegions:function(e){return this._regionManager.addRegions(e)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(e){this._regionManager.removeRegion(e)},getRegion:function(e){return this._regionManager.get(e)},module:function(e,t){var n=a.Module;t&&(n=t.moduleClass||n);var r=i(arguments);return r.unshift(this),n.create.apply(n,r)},_initRegionManager:function(){this._regionManager=new a.RegionManager,this.listenTo(this._regionManager,"region:add",function(e,t){this[e]=t}),this.listenTo(this._regionManager,"region:remove",function(e){delete this[e]})}}),a.Application.extend=a.extend,a.Module=function(e,t,i){this.moduleName=e,this.options=n.extend({},this.options,i),this.initialize=i.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=t,this.startWithParent=!0,this.triggerMethod=a.triggerMethod,n.isFunction(this.initialize)&&this.initialize(this.options,e,t)},a.Module.extend=a.extend,n.extend(a.Module.prototype,t.Events,{initialize:function(){},addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(e){this._isInitialized||(n.each(this.submodules,function(t){t.startWithParent&&t.start(e)}),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e))},stop:function(){this._isInitialized&&(this._isInitialized=!1,a.triggerMethod.call(this,"before:stop"),n.each(this.submodules,function(e){e.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),a.triggerMethod.call(this,"stop"))},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(e,i){if(e){var r=n.flatten([this,this.app,t,a,a.$,n,i]);e.apply(this,r)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new a.Callbacks,this._finalizerCallbacks=new a.Callbacks}}),n.extend(a.Module,{create:function(e,t,r){var a=e,s=i(arguments);s.splice(0,3),t=t.split(".");var o=t.length,l=[];return l[o-1]=r,n.each(t,function(t,n){var i=a;a=this._getModule(i,t,e,r),this._addModuleDefinition(i,a,l[n],s)},this),a},_getModule:function(e,t,i,r){var s=a.Module,o=n.extend({},r);r&&(s=r.moduleClass||s);var l=e[t];return l||(l=new s(t,i,o),e[t]=l,e.submodules[t]=l),l},_addModuleDefinition:function(e,t,i,r){var a,s;n.isFunction(i)?(a=i,s=!0):n.isObject(i)?(a=i.define,s="undefined"!=typeof i.startWithParent?i.startWithParent:!0):s=!0,a&&t.addDefinition(a,r),t.startWithParent=t.startWithParent&&s,t.startWithParent&&!t.startWithParentIsConfigured&&(t.startWithParentIsConfigured=!0,e.addInitializer(function(e){t.startWithParent&&t.start(e)}))}}),a}(this,t,e);return t.Marionette}),function(e,t){function n(n,i){function r(e){return ut.preferFlash&&rt&&!ut.ignoreFlash&&ut.flash[e]!==t&&ut.flash[e]}function a(e){return function(t){var n=this._s;return n&&n._a?e.call(this,t):null}}this.setupOptions={url:n||null,flashVersion:8,debugMode:!0,debugFlash:!1,useConsole:!0,consoleOnly:!0,waitForWindowLoad:!1,bgColor:"#ffffff",useHighPerformance:!1,flashPollingInterval:null,html5PollingInterval:null,flashLoadTimeout:1e3,wmode:null,allowScriptAccess:"always",useFlashBlock:!1,useHTML5Audio:!0,html5Test:/^(probably|maybe)$/i,preferFlash:!1,noSWFCache:!1,idPrefix:"sound"},this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100},this.flash9Options={isMovieStar:null,usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null},this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null},this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a","m4b"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},opus:{type:["audio/ogg; codecs=opus","audio/opus"],required:!1},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1}},this.movieID="sm2-container",this.id=i||"sm2movie",this.debugID="soundmanager-debug",this.debugURLParam=/([#?&])debug=1/i,this.versionNumber="V2.97a.20131201",this.altURL=this.movieURL=this.version=null,this.enabled=this.swfLoaded=!1,this.oMC=null,this.sounds={},this.soundIDs=[],this.didFlashBlock=this.muted=!1,this.filePattern=null,this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i},this.features={buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1},this.sandbox={},this.html5={usingFlash:null},this.flash={},this.ignoreFlash=this.html5Only=!1;var s,o,l,u,p,c,d,h,f,m,g,v,y,_,w,b,k,C,P,M,T,x,O,A,j,I,S,E,R,$,L,H,D,F,B,q,V,z,U,N,W,X,Y,Q,J,G,K,Z,et,tt,nt,it,rt,at,st,ot,lt,ut=this,pt=null,ct=null,dt=navigator.userAgent,ht=e.location.href.toString(),ft=document,mt=[],gt=!1,vt=!1,yt=!1,_t=!1,wt=!1,bt=null,kt=null,Ct=!1,Pt=!1,Mt=0,Tt=null,xt=[],Ot=null,At=Array.prototype.slice,jt=!1,It=0,St=dt.match(/(ipad|iphone|ipod)/i),Et=dt.match(/android/i),Rt=dt.match(/msie/i),$t=dt.match(/webkit/i),Lt=dt.match(/safari/i)&&!dt.match(/chrome/i),Ht=dt.match(/opera/i),Dt=dt.match(/(mobile|pre\/|xoom)/i)||St||Et,Ft=!ht.match(/usehtml5audio/i)&&!ht.match(/sm2\-ignorebadua/i)&&Lt&&!dt.match(/silk/i)&&dt.match(/OS X 10_6_([3-7])/i),Bt=ft.hasFocus!==t?ft.hasFocus():null,qt=Lt&&(ft.hasFocus===t||!ft.hasFocus()),Vt=!qt,zt=/(mp3|mp4|mpa|m4a|m4b)/i,Ut=ft.location?ft.location.protocol.match(/http/i):null,Nt=Ut?"":"http://",Wt=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|m4b|mp4v|3gp|3g2)\s*(?:$|;)/i,Xt="mpeg4 aac flv mov mp4 m4v f4v m4a m4b mp4v 3gp 3g2".split(" "),Yt=RegExp("\\.("+Xt.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i,this.useAltURL=!Ut;var Qt;try{Qt=Audio!==t&&(Ht&&opera!==t&&10>opera.version()?new Audio(null):new Audio).canPlayType!==t}catch(Jt){Qt=!1}this.hasHTML5=Qt,this.setup=function(e){var n=!ut.url;return e!==t&&yt&&Ot&&ut.ok(),f(e),e&&(n&&A&&e.url!==t&&ut.beginDelayedInit(),!A&&e.url!==t&&"complete"===ft.readyState&&setTimeout(x,1)),ut},this.supported=this.ok=function(){return Ot?yt&&!_t:ut.useHTML5Audio&&ut.hasHTML5},this.getMovie=function(t){return o(t)||ft[t]||e[t]},this.createSound=function(e,n){function i(){return r=q(r),ut.sounds[r.id]=new s(r),ut.soundIDs.push(r.id),ut.sounds[r.id]}var r,a=null;if(!yt||!ut.ok())return!1;if(n!==t&&(e={id:e,url:n}),r=h(e),r.url=X(r.url),void 0===r.id&&(r.id=ut.setupOptions.idPrefix+It++),z(r.id,!0))return ut.sounds[r.id];if(J(r))a=i(),a._setup_html5(r);else{if(ut.html5Only||ut.html5.usingFlash&&r.url&&r.url.match(/data\:/i))return i();c>8&&null===r.isMovieStar&&(r.isMovieStar=!(!r.serverURL&&!(r.type&&r.type.match(Wt)||r.url&&r.url.match(Yt)))),r=V(r,void 0),a=i(),8===c?ct._createSound(r.id,r.loops||1,r.usePolicyFile):(ct._createSound(r.id,r.url,r.usePeakData,r.useWaveformData,r.useEQData,r.isMovieStar,r.isMovieStar?r.bufferTime:!1,r.loops||1,r.serverURL,r.duration||null,r.autoPlay,!0,r.autoLoad,r.usePolicyFile),r.serverURL||(a.connected=!0,r.onconnect&&r.onconnect.apply(a))),!r.serverURL&&(r.autoLoad||r.autoPlay)&&a.load(r)}return!r.serverURL&&r.autoPlay&&a.play(),a},this.destroySound=function(e,t){if(!z(e))return!1;var n,i=ut.sounds[e];for(i._iO={},i.stop(),i.unload(),n=0;n<ut.soundIDs.length;n++)if(ut.soundIDs[n]===e){ut.soundIDs.splice(n,1);break}return t||i.destruct(!0),delete ut.sounds[e],!0},this.load=function(e,t){return z(e)?ut.sounds[e].load(t):!1},this.unload=function(e){return z(e)?ut.sounds[e].unload():!1},this.onposition=this.onPosition=function(e,t,n,i){return z(e)?ut.sounds[e].onposition(t,n,i):!1},this.clearOnPosition=function(e,t,n){return z(e)?ut.sounds[e].clearOnPosition(t,n):!1},this.start=this.play=function(e,t){var n=null,i=t&&!(t instanceof Object);if(!yt||!ut.ok())return!1;if(z(e,i))i&&(t={url:t});else{if(!i)return!1;i&&(t={url:t}),t&&t.url&&(t.id=e,n=ut.createSound(t).play())}return null===n&&(n=ut.sounds[e].play(t)),n},this.setPosition=function(e,t){return z(e)?ut.sounds[e].setPosition(t):!1},this.stop=function(e){return z(e)?ut.sounds[e].stop():!1},this.stopAll=function(){for(var e in ut.sounds)ut.sounds.hasOwnProperty(e)&&ut.sounds[e].stop()},this.pause=function(e){return z(e)?ut.sounds[e].pause():!1},this.pauseAll=function(){var e;for(e=ut.soundIDs.length-1;e>=0;e--)ut.sounds[ut.soundIDs[e]].pause()},this.resume=function(e){return z(e)?ut.sounds[e].resume():!1},this.resumeAll=function(){var e;for(e=ut.soundIDs.length-1;e>=0;e--)ut.sounds[ut.soundIDs[e]].resume()},this.togglePause=function(e){return z(e)?ut.sounds[e].togglePause():!1},this.setPan=function(e,t){return z(e)?ut.sounds[e].setPan(t):!1},this.setVolume=function(e,t){return z(e)?ut.sounds[e].setVolume(t):!1},this.mute=function(e){var t=0;if(e instanceof String&&(e=null),e)return z(e)?ut.sounds[e].mute():!1;for(t=ut.soundIDs.length-1;t>=0;t--)ut.sounds[ut.soundIDs[t]].mute();return ut.muted=!0},this.muteAll=function(){ut.mute()},this.unmute=function(e){if(e instanceof String&&(e=null),e)return z(e)?ut.sounds[e].unmute():!1;for(e=ut.soundIDs.length-1;e>=0;e--)ut.sounds[ut.soundIDs[e]].unmute();return ut.muted=!1,!0},this.unmuteAll=function(){ut.unmute()},this.toggleMute=function(e){return z(e)?ut.sounds[e].toggleMute():!1},this.getMemoryUse=function(){var e=0;return ct&&8!==c&&(e=parseInt(ct._getMemoryUse(),10)),e},this.disable=function(n){var i;if(n===t&&(n=!1),_t)return!1;for(_t=!0,i=ut.soundIDs.length-1;i>=0;i--)$(ut.sounds[ut.soundIDs[i]]);return d(n),nt.remove(e,"load",y),!0},this.canPlayMIME=function(e){var t;return ut.hasHTML5&&(t=G({type:e})),!t&&Ot&&(t=e&&ut.ok()?!!(c>8&&e.match(Wt)||e.match(ut.mimePattern)):null),t},this.canPlayURL=function(e){var t;return ut.hasHTML5&&(t=G({url:e})),!t&&Ot&&(t=e&&ut.ok()?!!e.match(ut.filePattern):null),t},this.canPlayLink=function(e){return e.type!==t&&e.type&&ut.canPlayMIME(e.type)?!0:ut.canPlayURL(e.href)},this.getSoundById=function(e){return e?ut.sounds[e]:null},this.onready=function(t,n){if("function"!=typeof t)throw D("needFunction","onready");return n||(n=e),g("onready",t,n),v(),!0},this.ontimeout=function(t,n){if("function"!=typeof t)throw D("needFunction","ontimeout");return n||(n=e),g("ontimeout",t,n),v({type:"ontimeout"}),!0},this._wD=this._writeDebug=function(){return!0},this._debug=function(){},this.reboot=function(t,n){var i,r,a;for(i=ut.soundIDs.length-1;i>=0;i--)ut.sounds[ut.soundIDs[i]].destruct();if(ct)try{Rt&&(kt=ct.innerHTML),bt=ct.parentNode.removeChild(ct)}catch(s){}if(kt=bt=Ot=ct=null,ut.enabled=A=yt=Ct=Pt=gt=vt=_t=jt=ut.swfLoaded=!1,ut.soundIDs=[],ut.sounds={},It=0,t)mt=[];else for(i in mt)if(mt.hasOwnProperty(i))for(r=0,a=mt[i].length;a>r;r++)mt[i][r].fired=!1;return ut.html5={usingFlash:null},ut.flash={},ut.html5Only=!1,ut.ignoreFlash=!1,e.setTimeout(function(){T(),n||ut.beginDelayedInit()},20),ut},this.reset=function(){return ut.reboot(!0,!0)},this.getMoviePercent=function(){return ct&&"PercentLoaded"in ct?ct.PercentLoaded():null},this.beginDelayedInit=function(){wt=!0,x(),setTimeout(function(){return Pt?!1:(I(),M(),Pt=!0)},20),_()},this.destruct=function(){ut.disable(!0)},s=function(e){var n,i,r,a,s,o,l,u,p,d,f,m=this,g=!1,v=[],y=0,_=null;i=n=null,this.sID=this.id=e.id,this.url=e.url,this._iO=this.instanceOptions=this.options=h(e),this.pan=this.options.pan,this.volume=this.options.volume,this.isHTML5=!1,this._a=null,f=this.url?!1:!0,this.id3={},this._debug=function(){},this.load=function(e){var n,i=null;if(e!==t?m._iO=h(e,m.options):(e=m.options,m._iO=e,_&&_!==m.url&&(m._iO.url=m.url,m.url=null)),m._iO.url||(m._iO.url=m.url),m._iO.url=X(m._iO.url),n=m.instanceOptions=m._iO,!n.url&&!m.url)return m;if(n.url===m.url&&0!==m.readyState&&2!==m.readyState)return 3===m.readyState&&n.onload&&lt(m,function(){n.onload.apply(m,[!!m.duration])}),m;if(m.loaded=!1,m.readyState=1,m.playState=0,m.id3={},J(n))i=m._setup_html5(n),i._called_load||(m._html5_canplay=!1,m.url!==n.url&&(m._a.src=n.url,m.setPosition(0)),m._a.autobuffer="auto",m._a.preload="auto",m._a._called_load=!0);else{if(ut.html5Only||m._iO.url&&m._iO.url.match(/data\:/i))return m;try{m.isHTML5=!1,m._iO=V(q(n)),n=m._iO,8===c?ct._load(m.id,n.url,n.stream,n.autoPlay,n.usePolicyFile):ct._load(m.id,n.url,!!n.stream,!!n.autoPlay,n.loops||1,!!n.autoLoad,n.usePolicyFile)}catch(r){S({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:!0})}}return m.url=n.url,m},this.unload=function(){return 0!==m.readyState&&(m.isHTML5?(o(),m._a&&(m._a.pause(),_=Z(m._a))):8===c?ct._unload(m.id,"about:blank"):ct._unload(m.id),r()),m},this.destruct=function(e){m.isHTML5?(o(),m._a&&(m._a.pause(),Z(m._a),jt||s(),m._a._s=null,m._a=null)):(m._iO.onfailure=null,ct._destroySound(m.id)),e||ut.destroySound(m.id,!0)},this.start=this.play=function(e,n){var i,r,a,s,o;if(r=!0,r=null,n=n===t?!0:n,e||(e={}),m.url&&(m._iO.url=m.url),m._iO=h(m._iO,m.options),m._iO=h(e,m._iO),m._iO.url=X(m._iO.url),m.instanceOptions=m._iO,!m.isHTML5&&m._iO.serverURL&&!m.connected)return m.getAutoPlay()||m.setAutoPlay(!0),m;if(J(m._iO)&&(m._setup_html5(m._iO),l()),1===m.playState&&!m.paused&&(i=m._iO.multiShot,i||(m.isHTML5&&m.setPosition(m._iO.position),r=m)),null!==r)return r;if(e.url&&e.url!==m.url&&(m.readyState||m.isHTML5||8!==c||!f?m.load(m._iO):f=!1),m.loaded||(0===m.readyState?(m.isHTML5||ut.html5Only?m.isHTML5?m.load(m._iO):r=m:(m._iO.autoPlay=!0,m.load(m._iO)),m.instanceOptions=m._iO):2===m.readyState&&(r=m)),null!==r)return r;if(!m.isHTML5&&9===c&&0<m.position&&m.position===m.duration&&(e.position=0),m.paused&&0<=m.position&&(!m._iO.serverURL||0<m.position))m.resume();else{if(m._iO=h(e,m._iO),null!==m._iO.from&&null!==m._iO.to&&0===m.instanceCount&&0===m.playState&&!m._iO.serverURL){if(i=function(){m._iO=h(e,m._iO),m.play(m._iO)},m.isHTML5&&!m._html5_canplay?(m.load({_oncanplay:i}),r=!1):m.isHTML5||m.loaded||m.readyState&&2===m.readyState||(m.load({onload:i}),r=!1),null!==r)return r;m._iO=d()}(!m.instanceCount||m._iO.multiShotEvents||m.isHTML5&&m._iO.multiShot&&!jt||!m.isHTML5&&c>8&&!m.getAutoPlay())&&m.instanceCount++,m._iO.onposition&&0===m.playState&&u(m),m.playState=1,m.paused=!1,m.position=m._iO.position===t||isNaN(m._iO.position)?0:m._iO.position,m.isHTML5||(m._iO=V(q(m._iO))),m._iO.onplay&&n&&(m._iO.onplay.apply(m),g=!0),m.setVolume(m._iO.volume,!0),m.setPan(m._iO.pan,!0),m.isHTML5?2>m.instanceCount?(l(),r=m._setup_html5(),m.setPosition(m._iO.position),r.play()):(a=new Audio(m._iO.url),s=function(){nt.remove(a,"ended",s),m._onfinish(m),Z(a),a=null},o=function(){nt.remove(a,"canplay",o);try{a.currentTime=m._iO.position/1e3}catch(e){}a.play()},nt.add(a,"ended",s),void 0!==m._iO.volume&&(a.volume=Math.max(0,Math.min(1,m._iO.volume/100))),m.muted&&(a.muted=!0),m._iO.position?nt.add(a,"canplay",o):a.play()):(r=ct._start(m.id,m._iO.loops||1,9===c?m.position:m.position/1e3,m._iO.multiShot||!1),9===c&&!r&&m._iO.onplayerror&&m._iO.onplayerror.apply(m))}return m},this.stop=function(e){var t=m._iO;return 1===m.playState&&(m._onbufferchange(0),m._resetOnPosition(0),m.paused=!1,m.isHTML5||(m.playState=0),p(),t.to&&m.clearOnPosition(t.to),m.isHTML5?m._a&&(e=m.position,m.setPosition(0),m.position=e,m._a.pause(),m.playState=0,m._onTimer(),o()):(ct._stop(m.id,e),t.serverURL&&m.unload()),m.instanceCount=0,m._iO={},t.onstop&&t.onstop.apply(m)),m},this.setAutoPlay=function(e){m._iO.autoPlay=e,m.isHTML5||(ct._setAutoPlay(m.id,e),e&&!m.instanceCount&&1===m.readyState&&m.instanceCount++)},this.getAutoPlay=function(){return m._iO.autoPlay},this.setPosition=function(e){e===t&&(e=0);var n=m.isHTML5?Math.max(e,0):Math.min(m.duration||m._iO.duration,Math.max(e,0));if(m.position=n,e=m.position/1e3,m._resetOnPosition(m.position),m._iO.position=n,m.isHTML5){if(m._a){if(m._html5_canplay){if(m._a.currentTime!==e)try{m._a.currentTime=e,(0===m.playState||m.paused)&&m._a.pause()}catch(i){}}else if(e)return m;m.paused&&m._onTimer(!0)}}else e=9===c?m.position:e,m.readyState&&2!==m.readyState&&ct._setPosition(m.id,e,m.paused||!m.playState,m._iO.multiShot);return m},this.pause=function(e){return m.paused||0===m.playState&&1!==m.readyState?m:(m.paused=!0,m.isHTML5?(m._setup_html5().pause(),o()):(e||e===t)&&ct._pause(m.id,m._iO.multiShot),m._iO.onpause&&m._iO.onpause.apply(m),m)},this.resume=function(){var e=m._iO;return m.paused?(m.paused=!1,m.playState=1,m.isHTML5?(m._setup_html5().play(),l()):(e.isMovieStar&&!e.serverURL&&m.setPosition(m.position),ct._pause(m.id,e.multiShot)),!g&&e.onplay?(e.onplay.apply(m),g=!0):e.onresume&&e.onresume.apply(m),m):m},this.togglePause=function(){return 0===m.playState?(m.play({position:9!==c||m.isHTML5?m.position/1e3:m.position}),m):(m.paused?m.resume():m.pause(),m)},this.setPan=function(e,n){return e===t&&(e=0),n===t&&(n=!1),m.isHTML5||ct._setPan(m.id,e),m._iO.pan=e,n||(m.pan=e,m.options.pan=e),m},this.setVolume=function(e,n){return e===t&&(e=100),n===t&&(n=!1),m.isHTML5?m._a&&(ut.muted&&!m.muted&&(m.muted=!0,m._a.muted=!0),m._a.volume=Math.max(0,Math.min(1,e/100))):ct._setVolume(m.id,ut.muted&&!m.muted||m.muted?0:e),m._iO.volume=e,n||(m.volume=e,m.options.volume=e),m},this.mute=function(){return m.muted=!0,m.isHTML5?m._a&&(m._a.muted=!0):ct._setVolume(m.id,0),m},this.unmute=function(){m.muted=!1;var e=m._iO.volume!==t;return m.isHTML5?m._a&&(m._a.muted=!1):ct._setVolume(m.id,e?m._iO.volume:m.options.volume),m},this.toggleMute=function(){return m.muted?m.unmute():m.mute()},this.onposition=this.onPosition=function(e,n,i){return v.push({position:parseInt(e,10),method:n,scope:i!==t?i:m,fired:!1}),m},this.clearOnPosition=function(e,t){var n;if(e=parseInt(e,10),isNaN(e))return!1;for(n=0;n<v.length;n++)e!==v[n].position||t&&t!==v[n].method||(v[n].fired&&y--,v.splice(n,1))},this._processOnPosition=function(){var e,t;if(e=v.length,!e||!m.playState||y>=e)return!1;for(e-=1;e>=0;e--)t=v[e],!t.fired&&m.position>=t.position&&(t.fired=!0,y++,t.method.apply(t.scope,[t.position]));return!0},this._resetOnPosition=function(e){var t,n;if(t=v.length,!t)return!1;for(t-=1;t>=0;t--)n=v[t],n.fired&&e<=n.position&&(n.fired=!1,y--);return!0},d=function(){var e,t,n=m._iO,i=n.from,r=n.to;return t=function(){m.clearOnPosition(r,t),m.stop()},e=function(){null===r||isNaN(r)||m.onPosition(r,t)},null!==i&&!isNaN(i)&&(n.position=i,n.multiShot=!1,e()),n},u=function(){var e,t=m._iO.onposition;if(t)for(e in t)t.hasOwnProperty(e)&&m.onPosition(parseInt(e,10),t[e])},p=function(){var e,t=m._iO.onposition;if(t)for(e in t)t.hasOwnProperty(e)&&m.clearOnPosition(parseInt(e,10))},l=function(){m.isHTML5&&U(m)},o=function(){m.isHTML5&&N(m)
},r=function(e){e||(v=[],y=0),g=!1,m._hasTimer=null,m._a=null,m._html5_canplay=!1,m.bytesLoaded=null,m.bytesTotal=null,m.duration=m._iO&&m._iO.duration?m._iO.duration:null,m.durationEstimate=null,m.buffered=[],m.eqData=[],m.eqData.left=[],m.eqData.right=[],m.failures=0,m.isBuffering=!1,m.instanceOptions={},m.instanceCount=0,m.loaded=!1,m.metadata={},m.readyState=0,m.muted=!1,m.paused=!1,m.peakData={left:0,right:0},m.waveformData={left:[],right:[]},m.playState=0,m.position=null,m.id3={}},r(),this._onTimer=function(e){var t,r=!1,a={};return m._hasTimer||e?(m._a&&(e||(0<m.playState||1===m.readyState)&&!m.paused)&&(t=m._get_html5_duration(),t!==n&&(n=t,m.duration=t,r=!0),m.durationEstimate=m.duration,t=1e3*m._a.currentTime||0,t!==i&&(i=t,r=!0),(r||e)&&m._whileplaying(t,a,a,a,a)),r):void 0},this._get_html5_duration=function(){var e=m._iO;return(e=m._a&&m._a.duration?1e3*m._a.duration:e&&e.duration?e.duration:null)&&!isNaN(e)&&1/0!==e?e:null},this._apply_loop=function(e,t){e.loop=t>1?"loop":""},this._setup_html5=function(e){e=h(m._iO,e);var t,n=jt?pt:m._a,i=decodeURI(e.url);if(jt?i===decodeURI(it)&&(t=!0):i===decodeURI(_)&&(t=!0),n){if(n._s)if(jt)n._s&&n._s.playState&&!t&&n._s.stop();else if(!jt&&i===decodeURI(_))return m._apply_loop(n,e.loops),n;t||(_&&r(!1),n.src=e.url,it=_=m.url=e.url,n._called_load=!1)}else e.autoLoad||e.autoPlay?(m._a=new Audio(e.url),m._a.load()):m._a=Ht&&10>opera.version()?new Audio(null):new Audio,n=m._a,n._called_load=!1,jt&&(pt=n);return m.isHTML5=!0,m._a=n,n._s=m,a(),m._apply_loop(n,e.loops),e.autoLoad||e.autoPlay?m.load():(n.autobuffer=!1,n.preload="auto"),n},a=function(){if(m._a._added_events)return!1;var e;m._a._added_events=!0;for(e in ot)ot.hasOwnProperty(e)&&m._a&&m._a.addEventListener(e,ot[e],!1);return!0},s=function(){var e;m._a._added_events=!1;for(e in ot)ot.hasOwnProperty(e)&&m._a&&m._a.removeEventListener(e,ot[e],!1)},this._onload=function(e){var t=!!e||!m.isHTML5&&8===c&&m.duration;return m.loaded=t,m.readyState=t?3:2,m._onbufferchange(0),m._iO.onload&&lt(m,function(){m._iO.onload.apply(m,[t])}),!0},this._onbufferchange=function(e){return 0===m.playState||e&&m.isBuffering||!e&&!m.isBuffering?!1:(m.isBuffering=1===e,m._iO.onbufferchange&&m._iO.onbufferchange.apply(m),!0)},this._onsuspend=function(){return m._iO.onsuspend&&m._iO.onsuspend.apply(m),!0},this._onfailure=function(e,t,n){m.failures++,m._iO.onfailure&&1===m.failures&&m._iO.onfailure(m,e,t,n)},this._onfinish=function(){var e=m._iO.onfinish;m._onbufferchange(0),m._resetOnPosition(0),m.instanceCount&&(m.instanceCount--,m.instanceCount||(p(),m.playState=0,m.paused=!1,m.instanceCount=0,m.instanceOptions={},m._iO={},o(),m.isHTML5&&(m.position=0)),(!m.instanceCount||m._iO.multiShotEvents)&&e&&lt(m,function(){e.apply(m)}))},this._whileloading=function(e,t,n,i){var r=m._iO;m.bytesLoaded=e,m.bytesTotal=t,m.duration=Math.floor(n),m.bufferLength=i,m.durationEstimate=m.isHTML5||r.isMovieStar?m.duration:r.duration?m.duration>r.duration?m.duration:r.duration:parseInt(m.bytesTotal/m.bytesLoaded*m.duration,10),m.isHTML5||(m.buffered=[{start:0,end:m.duration}]),(3!==m.readyState||m.isHTML5)&&r.whileloading&&r.whileloading.apply(m)},this._whileplaying=function(e,n,i,r,a){var s=m._iO;return isNaN(e)||null===e?!1:(m.position=Math.max(0,e),m._processOnPosition(),!m.isHTML5&&c>8&&(s.usePeakData&&n!==t&&n&&(m.peakData={left:n.leftPeak,right:n.rightPeak}),s.useWaveformData&&i!==t&&i&&(m.waveformData={left:i.split(","),right:r.split(",")}),s.useEQData&&a!==t&&a&&a.leftEQ&&(e=a.leftEQ.split(","),m.eqData=e,m.eqData.left=e,a.rightEQ!==t&&a.rightEQ&&(m.eqData.right=a.rightEQ.split(",")))),1===m.playState&&(!m.isHTML5&&8===c&&!m.position&&m.isBuffering&&m._onbufferchange(0),s.whileplaying&&s.whileplaying.apply(m)),!0)},this._oncaptiondata=function(e){m.captiondata=e,m._iO.oncaptiondata&&m._iO.oncaptiondata.apply(m,[e])},this._onmetadata=function(e,t){var n,i,r={};for(n=0,i=e.length;i>n;n++)r[e[n]]=t[n];m.metadata=r,m._iO.onmetadata&&m._iO.onmetadata.apply(m)},this._onid3=function(e,t){var n,i,r=[];for(n=0,i=e.length;i>n;n++)r[e[n]]=t[n];m.id3=h(m.id3,r),m._iO.onid3&&m._iO.onid3.apply(m)},this._onconnect=function(e){e=1===e,(m.connected=e)&&(m.failures=0,z(m.id)&&(m.getAutoPlay()?m.play(t,m.getAutoPlay()):m._iO.autoLoad&&m.load()),m._iO.onconnect&&m._iO.onconnect.apply(m,[e]))},this._ondataerror=function(){0<m.playState&&m._iO.ondataerror&&m._iO.ondataerror.apply(m)}},j=function(){return ft.body||ft.getElementsByTagName("div")[0]},o=function(e){return ft.getElementById(e)},h=function(e,n){var i,r,a=e||{};i=n===t?ut.defaultOptions:n;for(r in i)i.hasOwnProperty(r)&&a[r]===t&&(a[r]="object"!=typeof i[r]||null===i[r]?i[r]:h(a[r],i[r]));return a},lt=function(t,n){t.isHTML5||8!==c?n():e.setTimeout(n,0)},m={onready:1,ontimeout:1,defaultOptions:1,flash9Options:1,movieStarOptions:1},f=function(e,n){var i,r=!0,a=n!==t,s=ut.setupOptions;for(i in e)if(e.hasOwnProperty(i))if("object"!=typeof e[i]||null===e[i]||e[i]instanceof Array||e[i]instanceof RegExp)a&&m[n]!==t?ut[n][i]=e[i]:s[i]!==t?(ut.setupOptions[i]=e[i],ut[i]=e[i]):m[i]===t?r=!1:ut[i]instanceof Function?ut[i].apply(ut,e[i]instanceof Array?e[i]:[e[i]]):ut[i]=e[i];else{if(m[i]!==t)return f(e[i],i);r=!1}return r},nt=function(){function t(e){e=At.call(e);var t=e.length;return i?(e[1]="on"+e[1],t>3&&e.pop()):3===t&&e.push(!1),e}function n(e,t){var n=e.shift(),a=[r[t]];i?n[a](e[0],e[1]):n[a].apply(n,e)}var i=e.attachEvent,r={add:i?"attachEvent":"addEventListener",remove:i?"detachEvent":"removeEventListener"};return{add:function(){n(t(arguments),"add")},remove:function(){n(t(arguments),"remove")}}}(),ot={abort:a(function(){}),canplay:a(function(){var e,n=this._s;if(n._html5_canplay)return!0;if(n._html5_canplay=!0,n._onbufferchange(0),e=n._iO.position===t||isNaN(n._iO.position)?null:n._iO.position/1e3,n.position&&this.currentTime!==e)try{this.currentTime=e}catch(i){}n._iO._oncanplay&&n._iO._oncanplay()}),canplaythrough:a(function(){var e=this._s;e.loaded||(e._onbufferchange(0),e._whileloading(e.bytesLoaded,e.bytesTotal,e._get_html5_duration()),e._onload(!0))}),ended:a(function(){this._s._onfinish()}),error:a(function(){this._s._onload(!1)}),loadeddata:a(function(){var e=this._s;!e._loaded&&!Lt&&(e.duration=e._get_html5_duration())}),loadedmetadata:a(function(){}),loadstart:a(function(){this._s._onbufferchange(1)}),play:a(function(){this._s._onbufferchange(0)}),playing:a(function(){this._s._onbufferchange(0)}),progress:a(function(e){var t,n,i=this._s,r=0,r=e.target.buffered;t=e.loaded||0;var a=e.total||1;if(i.buffered=[],r&&r.length){for(t=0,n=r.length;n>t;t++)i.buffered.push({start:1e3*r.start(t),end:1e3*r.end(t)});r=1e3*(r.end(0)-r.start(0)),t=Math.min(1,r/(1e3*e.target.duration))}isNaN(t)||(i._onbufferchange(0),i._whileloading(t,a,i._get_html5_duration()),t&&a&&t===a&&ot.canplaythrough.call(this,e))}),ratechange:a(function(){}),suspend:a(function(e){var t=this._s;ot.progress.call(this,e),t._onsuspend()}),stalled:a(function(){}),timeupdate:a(function(){this._s._onTimer()}),waiting:a(function(){this._s._onbufferchange(1)})},J=function(e){return e&&(e.type||e.url||e.serverURL)?e.serverURL||e.type&&r(e.type)?!1:e.type?G({type:e.type}):G({url:e.url})||ut.html5Only||e.url.match(/data\:/i):!1},Z=function(e){var t;return e&&(t=Lt?"about:blank":ut.html5.canPlayType("audio/wav")?"data:audio/wave;base64,/UklGRiYAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQIAAAD//w==":"about:blank",e.src=t,void 0!==e._called_unload&&(e._called_load=!1)),jt&&(it=null),t},G=function(e){if(!ut.useHTML5Audio||!ut.hasHTML5)return!1;var n=e.url||null;e=e.type||null;var i,a=ut.audioFormats;if(e&&ut.html5[e]!==t)return ut.html5[e]&&!r(e);if(!K){K=[];for(i in a)a.hasOwnProperty(i)&&(K.push(i),a[i].related&&(K=K.concat(a[i].related)));K=RegExp("\\.("+K.join("|")+")(\\?.*)?$","i")}return i=n?n.toLowerCase().match(K):null,i&&i.length?i=i[1]:e&&(n=e.indexOf(";"),i=(-1!==n?e.substr(0,n):e).substr(6)),i&&ut.html5[i]!==t?n=ut.html5[i]&&!r(i):(e="audio/"+i,n=ut.html5.canPlayType({type:e}),n=(ut.html5[i]=n)&&ut.html5[e]&&!r(e)),n},tt=function(){function e(e){var t,n=t=!1;if(!s||"function"!=typeof s.canPlayType)return t;if(e instanceof Array){for(a=0,t=e.length;t>a;a++)(ut.html5[e[a]]||s.canPlayType(e[a]).match(ut.html5Test))&&(n=!0,ut.html5[e[a]]=!0,ut.flash[e[a]]=!!e[a].match(zt));t=n}else e=s&&"function"==typeof s.canPlayType?s.canPlayType(e):!1,t=!(!e||!e.match(ut.html5Test));return t}if(!ut.useHTML5Audio||!ut.hasHTML5)return Ot=ut.html5.usingFlash=!0,!1;var n,i,r,a,s=Audio!==t?Ht&&10>opera.version()?new Audio(null):new Audio:null,o={};r=ut.audioFormats;for(n in r)if(r.hasOwnProperty(n)&&(i="audio/"+n,o[n]=e(r[n].type),o[i]=o[n],n.match(zt)?(ut.flash[n]=!0,ut.flash[i]=!0):(ut.flash[n]=!1,ut.flash[i]=!1),r[n]&&r[n].related))for(a=r[n].related.length-1;a>=0;a--)o["audio/"+r[n].related[a]]=o[n],ut.html5[r[n].related[a]]=o[n],ut.flash[r[n].related[a]]=o[n];return o.canPlayType=s?e:null,ut.html5=h(ut.html5,o),ut.html5.usingFlash=Q(),Ot=ut.html5.usingFlash,!0},P={},D=function(){},q=function(e){return 8===c&&1<e.loops&&e.stream&&(e.stream=!1),e},V=function(e){return e&&!e.usePolicyFile&&(e.onid3||e.usePeakData||e.useWaveformData||e.useEQData)&&(e.usePolicyFile=!0),e},l=function(){return!1},$=function(e){for(var t in e)e.hasOwnProperty(t)&&"function"==typeof e[t]&&(e[t]=l)},L=function(e){e===t&&(e=!1),(_t||e)&&ut.disable(e)},H=function(e){var t=null;if(e)if(e.match(/\.swf(\?.*)?$/i)){if(t=e.substr(e.toLowerCase().lastIndexOf(".swf?")+4))return e}else e.lastIndexOf("/")!==e.length-1&&(e+="/");return e=(e&&-1!==e.lastIndexOf("/")?e.substr(0,e.lastIndexOf("/")+1):"./")+ut.movieURL,ut.noSWFCache&&(e+="?ts="+(new Date).getTime()),e},k=function(){c=parseInt(ut.flashVersion,10),8!==c&&9!==c&&(ut.flashVersion=c=8);var e=ut.debugMode||ut.debugFlash?"_debug.swf":".swf";ut.useHTML5Audio&&!ut.html5Only&&ut.audioFormats.mp4.required&&9>c&&(ut.flashVersion=c=9),ut.version=ut.versionNumber+(ut.html5Only?" (HTML5-only mode)":9===c?" (AS3/Flash 9)":" (AS2/Flash 8)"),c>8?(ut.defaultOptions=h(ut.defaultOptions,ut.flash9Options),ut.features.buffering=!0,ut.defaultOptions=h(ut.defaultOptions,ut.movieStarOptions),ut.filePatterns.flash9=RegExp("\\.(mp3|"+Xt.join("|")+")(\\?.*)?$","i"),ut.features.movieStar=!0):ut.features.movieStar=!1,ut.filePattern=ut.filePatterns[8!==c?"flash9":"flash8"],ut.movieURL=(8===c?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",e),ut.features.peakData=ut.features.waveformData=ut.features.eqData=c>8},E=function(e,t){return ct?void ct._setPolling(e,t):!1},R=function(){},z=this.getSoundById,B=function(){var e=[];return ut.debugMode&&e.push("sm2_debug"),ut.debugFlash&&e.push("flash_debug"),ut.useHighPerformance&&e.push("high_performance"),e.join(" ")},F=function(){D("fbHandler");var e=ut.getMoviePercent(),t={type:"FLASHBLOCK"};return ut.html5Only?!1:void(ut.ok()?ut.oMC&&(ut.oMC.className=[B(),"movieContainer","swf_loaded"+(ut.didFlashBlock?" swf_unblocked":"")].join(" ")):(Ot&&(ut.oMC.className=B()+" movieContainer "+(null===e?"swf_timedout":"swf_error")),ut.didFlashBlock=!0,v({type:"ontimeout",ignoreInit:!0,error:t}),S(t)))},g=function(e,n,i){mt[e]===t&&(mt[e]=[]),mt[e].push({method:n,scope:i||null,fired:!1})},v=function(e){if(e||(e={type:ut.ok()?"onready":"ontimeout"}),!yt&&e&&!e.ignoreInit||"ontimeout"===e.type&&(ut.ok()||_t&&!e.ignoreInit))return!1;var t,n={success:e&&e.ignoreInit?ut.ok():!_t},i=e&&e.type?mt[e.type]||[]:[],r=[],n=[n],a=Ot&&!ut.ok();for(e.error&&(n[0].error=e.error),e=0,t=i.length;t>e;e++)!0!==i[e].fired&&r.push(i[e]);if(r.length)for(e=0,t=r.length;t>e;e++)r[e].scope?r[e].method.apply(r[e].scope,n):r[e].method.apply(this,n),a||(r[e].fired=!0);return!0},y=function(){e.setTimeout(function(){ut.useFlashBlock&&F(),v(),"function"==typeof ut.onload&&ut.onload.apply(e),ut.waitForWindowLoad&&nt.add(e,"load",y)},1)},at=function(){if(rt!==t)return rt;var n,i=!1,r=navigator,a=r.plugins,s=e.ActiveXObject;if(a&&a.length)(r=r.mimeTypes)&&r["application/x-shockwave-flash"]&&r["application/x-shockwave-flash"].enabledPlugin&&r["application/x-shockwave-flash"].enabledPlugin.description&&(i=!0);else if(s!==t&&!dt.match(/MSAppHost/i)){try{n=new s("ShockwaveFlash.ShockwaveFlash")}catch(o){n=null}i=!!n}return rt=i},Q=function(){var e,t,n=ut.audioFormats;if(St&&dt.match(/os (1|2|3_0|3_1)/i)?(ut.hasHTML5=!1,ut.html5Only=!0,ut.oMC&&(ut.oMC.style.display="none")):!ut.useHTML5Audio||ut.html5&&ut.html5.canPlayType||(ut.hasHTML5=!1),ut.useHTML5Audio&&ut.hasHTML5)for(t in Y=!0,n)n.hasOwnProperty(t)&&n[t].required&&(ut.html5.canPlayType(n[t].type)?ut.preferFlash&&(ut.flash[t]||ut.flash[n[t].type])&&(e=!0):(Y=!1,e=!0));return ut.ignoreFlash&&(e=!1,Y=!0),ut.html5Only=ut.hasHTML5&&ut.useHTML5Audio&&!e,!ut.html5Only},X=function(e){var t,n,i=0;if(e instanceof Array){for(t=0,n=e.length;n>t;t++)if(e[t]instanceof Object){if(ut.canPlayMIME(e[t].type)){i=t;break}}else if(ut.canPlayURL(e[t])){i=t;break}e[i].url&&(e[i]=e[i].url),e=e[i]}return e},U=function(e){e._hasTimer||(e._hasTimer=!0,!Dt&&ut.html5PollingInterval&&(null===Tt&&0===Mt&&(Tt=setInterval(W,ut.html5PollingInterval)),Mt++))},N=function(e){e._hasTimer&&(e._hasTimer=!1,!Dt&&ut.html5PollingInterval&&Mt--)},W=function(){var e;if(null!==Tt&&!Mt)return clearInterval(Tt),Tt=null,!1;for(e=ut.soundIDs.length-1;e>=0;e--)ut.sounds[ut.soundIDs[e]].isHTML5&&ut.sounds[ut.soundIDs[e]]._hasTimer&&ut.sounds[ut.soundIDs[e]]._onTimer()},S=function(n){n=n!==t?n:{},"function"==typeof ut.onerror&&ut.onerror.apply(e,[{type:n.type!==t?n.type:null}]),n.fatal!==t&&n.fatal&&ut.disable()},st=function(){if(!Ft||!at())return!1;var e,t,n=ut.audioFormats;for(t in n)if(n.hasOwnProperty(t)&&("mp3"===t||"mp4"===t)&&(ut.html5[t]=!1,n[t]&&n[t].related))for(e=n[t].related.length-1;e>=0;e--)ut.html5[n[t].related[e]]=!1},this._setSandboxType=function(){},this._externalInterfaceOK=function(){return ut.swfLoaded?!1:(ut.swfLoaded=!0,qt=!1,Ft&&st(),void setTimeout(p,Rt?100:1))},I=function(e,n){function i(e,t){return'<param name="'+e+'" value="'+t+'" />'}if(gt&&vt)return!1;if(ut.html5Only)return k(),ut.oMC=o(ut.movieID),p(),vt=gt=!0,!1;var r,a,s,l=n||ut.url,u=ut.altURL||l,c=j(),d=B(),h=null,h=ft.getElementsByTagName("html")[0],h=h&&h.dir&&h.dir.match(/rtl/i);if(e=e===t?ut.id:e,k(),ut.url=H(Ut?l:u),n=ut.url,ut.wmode=!ut.wmode&&ut.useHighPerformance?"transparent":ut.wmode,null!==ut.wmode&&(dt.match(/msie 8/i)||!Rt&&!ut.useHighPerformance)&&navigator.platform.match(/win32|win64/i)&&(xt.push(P.spcWmode),ut.wmode=null),c={name:e,id:e,src:n,quality:"high",allowScriptAccess:ut.allowScriptAccess,bgcolor:ut.bgColor,pluginspage:Nt+"www.macromedia.com/go/getflashplayer",title:"JS/Flash audio component (SoundManager 2)",type:"application/x-shockwave-flash",wmode:ut.wmode,hasPriority:"true"},ut.debugFlash&&(c.FlashVars="debug=1"),ut.wmode||delete c.wmode,Rt)l=ft.createElement("div"),a=['<object id="'+e+'" data="'+n+'" type="'+c.type+'" title="'+c.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+Nt+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">',i("movie",n),i("AllowScriptAccess",ut.allowScriptAccess),i("quality",c.quality),ut.wmode?i("wmode",ut.wmode):"",i("bgcolor",ut.bgColor),i("hasPriority","true"),ut.debugFlash?i("FlashVars",c.FlashVars):"","</object>"].join("");else for(r in l=ft.createElement("embed"),c)c.hasOwnProperty(r)&&l.setAttribute(r,c[r]);if(R(),d=B(),c=j())if(ut.oMC=o(ut.movieID)||ft.createElement("div"),ut.oMC.id)s=ut.oMC.className,ut.oMC.className=(s?s+" ":"movieContainer")+(d?" "+d:""),ut.oMC.appendChild(l),Rt&&(r=ut.oMC.appendChild(ft.createElement("div")),r.className="sm2-object-box",r.innerHTML=a),vt=!0;else{if(ut.oMC.id=ut.movieID,ut.oMC.className="movieContainer "+d,r=d=null,ut.useFlashBlock||(ut.useHighPerformance?d={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}:(d={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},h&&(d.left=Math.abs(parseInt(d.left,10))+"px"))),$t&&(ut.oMC.style.zIndex=1e4),!ut.debugFlash)for(s in d)d.hasOwnProperty(s)&&(ut.oMC.style[s]=d[s]);try{Rt||ut.oMC.appendChild(l),c.appendChild(ut.oMC),Rt&&(r=ut.oMC.appendChild(ft.createElement("div")),r.className="sm2-object-box",r.innerHTML=a),vt=!0}catch(f){throw Error(D("domError")+" \n"+f.toString())}}return gt=!0},M=function(){return ut.html5Only?(I(),!1):ct||!ut.url?!1:(ct=ut.getMovie(ut.id),ct||(bt?(Rt?ut.oMC.innerHTML=kt:ut.oMC.appendChild(bt),bt=null,gt=!0):I(ut.id,ut.url),ct=ut.getMovie(ut.id)),"function"==typeof ut.oninitmovie&&setTimeout(ut.oninitmovie,1),!0)},_=function(){setTimeout(w,1e3)},b=function(){e.setTimeout(function(){ut.setup({preferFlash:!1}).reboot(),ut.didFlashBlock=!0,ut.beginDelayedInit()},1)},w=function(){var t,n=!1;return!ut.url||Ct?!1:(Ct=!0,nt.remove(e,"load",_),rt&&qt&&!Bt?!1:(yt||(t=ut.getMoviePercent(),t>0&&100>t&&(n=!0)),void setTimeout(function(){return t=ut.getMoviePercent(),n?(Ct=!1,e.setTimeout(_,1),!1):void(!yt&&Vt&&(null===t?ut.useFlashBlock||0===ut.flashLoadTimeout?ut.useFlashBlock&&F():!ut.useFlashBlock&&Y?b():v({type:"ontimeout",ignoreInit:!0,error:{type:"INIT_FLASHBLOCK"}}):0!==ut.flashLoadTimeout&&(!ut.useFlashBlock&&Y?b():L(!0))))},ut.flashLoadTimeout)))},C=function(){return Bt||!qt?(nt.remove(e,"focus",C),!0):(Bt=Vt=!0,Ct=!1,_(),nt.remove(e,"focus",C),!0)},d=function(t){if(yt)return!1;if(ut.html5Only)return yt=!0,y(),!0;var n,i=!0;return ut.useFlashBlock&&ut.flashLoadTimeout&&!ut.getMoviePercent()||(yt=!0),n={type:!rt&&Ot?"NO_FLASH":"INIT_TIMEOUT"},(_t||t)&&(ut.useFlashBlock&&ut.oMC&&(ut.oMC.className=B()+" "+(null===ut.getMoviePercent()?"swf_timedout":"swf_error")),v({type:"ontimeout",error:n,ignoreInit:!0}),S(n),i=!1),_t||(ut.waitForWindowLoad&&!wt?nt.add(e,"load",y):y()),i},u=function(){var e,n=ut.setupOptions;for(e in n)n.hasOwnProperty(e)&&(ut[e]===t?ut[e]=n[e]:ut[e]!==n[e]&&(ut.setupOptions[e]=ut[e]))},p=function(){if(yt)return!1;if(ut.html5Only)return yt||(nt.remove(e,"load",ut.beginDelayedInit),ut.enabled=!0,d()),!0;M();try{ct._externalInterfaceTest(!1),E(!0,ut.flashPollingInterval||(ut.useHighPerformance?10:50)),ut.debugMode||ct._disableDebug(),ut.enabled=!0,ut.html5Only||nt.add(e,"unload",l)}catch(t){return S({type:"JS_TO_FLASH_EXCEPTION",fatal:!0}),L(!0),d(),!1}return d(),nt.remove(e,"load",ut.beginDelayedInit),!0},x=function(){return A?!1:(A=!0,u(),R(),!rt&&ut.hasHTML5&&ut.setup({useHTML5Audio:!0,preferFlash:!1}),tt(),!rt&&Ot&&(xt.push(P.needFlash),ut.setup({flashLoadTimeout:1})),ft.removeEventListener&&ft.removeEventListener("DOMContentLoaded",x,!1),M(),!0)},et=function(){return"complete"===ft.readyState&&(x(),ft.detachEvent("onreadystatechange",et)),!0},O=function(){wt=!0,nt.remove(e,"load",O)},T=function(){Dt&&(ut.setupOptions.useHTML5Audio=!0,ut.setupOptions.preferFlash=!1,St||Et&&!dt.match(/android\s2\.3/i))&&(St&&(ut.ignoreFlash=!0),jt=!0)},T(),at(),nt.add(e,"focus",C),nt.add(e,"load",_),nt.add(e,"load",O),ft.addEventListener?ft.addEventListener("DOMContentLoaded",x,!1):ft.attachEvent?ft.attachEvent("onreadystatechange",et):S({type:"NO_DOM2_EVENTS",fatal:!0})}var i=null;void 0!==e.SM2_DEFER&&SM2_DEFER||(i=new n),e.SoundManager=n,e.soundManager=i}(window),r("soundmanager2",function(e){return function(){var t;return t||e.soundManager}}(this)),r("text",["module"],function(e){"use strict";var t,n,r,a,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,p="undefined"!=typeof location&&location.href,c=p&&location.protocol&&location.protocol.replace(/\:/,""),d=p&&location.hostname,h=p&&(location.port||void 0),f={},m=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(l,"");var t=e.match(u);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(i){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,i,r=!1,a=e.indexOf("."),s=0===e.indexOf("./")||0===e.indexOf("../");return-1!==a&&(!s||a>1)?(t=e.substring(0,a),n=e.substring(a+1,e.length)):t=e,i=n||t,a=i.indexOf("!"),-1!==a&&(r="strip"===i.substring(a+1),i=i.substring(0,a),n?n=i:t=i),{moduleName:t,ext:n,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,r){var a,s,o,l=t.xdRegExp.exec(e);return l?(a=l[2],s=l[3],s=s.split(":"),o=s[1],s=s[0],!(a&&a!==n||s&&s.toLowerCase()!==i.toLowerCase()||(o||s)&&o!==r)):!0},finishLoad:function(e,n,i,r){i=n?t.strip(i):i,m.isBuild&&(f[e]=i),r(i)},load:function(e,n,i,r){if(r.isBuild&&!r.inlineText)return void i();m.isBuild=r.isBuild;var a=t.parseName(e),s=a.moduleName+(a.ext?"."+a.ext:""),o=n.toUrl(s),l=m.useXhr||t.useXhr;return 0===o.indexOf("empty:")?void i():void(!p||l(o,c,d,h)?t.get(o,function(n){t.finishLoad(e,a.strip,n,i)},function(e){i.error&&i.error(e)}):n([s],function(e){t.finishLoad(a.moduleName+"."+a.ext,a.strip,e,i)}))},write:function(e,n,i){if(f.hasOwnProperty(n)){var r=t.jsEscape(f[n]);i.asModule(e+"!"+n,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,n,i,r,a){var s=t.parseName(n),o=s.ext?"."+s.ext:"",l=s.moduleName+o,u=i.toUrl(s.moduleName+o)+".js";t.load(l,i,function(){var n=function(e){return r(u,e)};n.asModule=function(e,t){return r.asModule(e,u,t)},t.write(e,l,n,a)},a)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(n=i.nodeRequire("fs"),t.get=function(e,t,i){try{var r=n.readFileSync(e,"utf8");0===r.indexOf("﻿")&&(r=r.substring(1)),t(r)}catch(a){i(a)}}):"xhr"===m.env||!m.env&&t.createXhr()?t.get=function(e,n,i,r){var a,s=t.createXhr();if(s.open("GET",e,!0),r)for(a in r)r.hasOwnProperty(a)&&s.setRequestHeader(a.toLowerCase(),r[a]);m.onXhr&&m.onXhr(s,e),s.onreadystatechange=function(){var t,r;4===s.readyState&&(t=s.status,t>399&&600>t?(r=new Error(e+" HTTP status: "+t),r.xhr=s,i(r)):n(s.responseText),m.onXhrComplete&&m.onXhrComplete(s,e))},s.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,i,r="utf-8",a=new java.io.File(e),s=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(a),r)),l="";try{for(n=new java.lang.StringBuffer,i=o.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=o.readLine());)n.append(s),n.append(i);l=String(n.toString())}finally{o.close()}t(l)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,a=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,i,o,l={};s&&(e=e.replace(/\//g,"\\")),o=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(a.nsIFileInputStream),n.init(o,1,0,!1),i=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(a.nsIConverterInputStream),i.init(n,"utf-8",n.available(),a.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),i.readString(n.available(),l),i.close(),n.close(),t(l.value)}catch(u){throw new Error((o&&o.path||"")+": "+u)}}),t}),r("text!templates/spp-template.html",[],function(){return'<div class="spp-player-container"></div>\r\n<div class="spp-player-body">\r\n	<div class="spp-track-details-container"></div>\r\n	<div class="spp-playlist-container"></div>\r\n</div>\r\n<div style="clear: both;"></div>\r\n'}),r("text!templates/player-template.html",[],function(){return'<% if ( data.show_logo != undefined && data.show_logo != null ) { %>\r\n	<div class="spp-show-logo">\r\n		<img src="<%= data.show_logo %>" alt="<%= data.show_name %>" />\r\n	</div>\r\n<% } %>\r\n\r\n<div class="spp-track" data-track-id="<%= \'track_\' + data.cid %>">\r\n	<p class="spp-show-title"><%= data.show_name %><span class="spp-show-count"></span></p>\r\n	<h3 class="spp-track-title"><%= data.title %></h3>\r\n	<p class="spp-duration"></p>\r\n	\r\n	<div class="spp-progress">\r\n		<div class="spp-current-time"></div>\r\n		<div class="spp-position"></div>\r\n		<div class="spp-total-time"></div>\r\n	</div>\r\n\r\n	<div class="spp-loaded-container">\r\n		<div class="spp-loaded"></div>\r\n	</div>\r\n	\r\n	<div class="spp-controls">\r\n		<% if ( data.paid == true ) { %>\r\n			<% if ( data.speedcontrol == true ) { %>\r\n				<span class="spp-speed"></span>\r\n			<% } %>\r\n		<% } %>\r\n		<span class="spp-previous"></span>\r\n		<span class="spp-play"></span>\r\n		<span class="spp-next"></span>\r\n	</div>\r\n\r\n	<a href="" class="spp-button spp-show-notes-button">Show Notes</a>\r\n	\r\n</div>'}),r("text!templates/podcast-track-template.html",[],function(){return'<div class="spp-track-row">\r\n	<div class="spp-episode"><span class="spp-number"><%= parseInt( data.episode_number, 10) %></span><span class="spp-play"></span></div>\r\n	<div class="spp-track-title"><h3 class="spp-playlist-track-title"><%= data.title_without_episode_number %></h3></div>\r\n</div>'}),r("text!templates/playlist-template.html",[],function(){return'<div class="spp-playlist-header"></div>\r\n<div class="spp-playlist-tracks"></div>\r\n<div class="spp-playlist-footer"></div>'}),r("text!templates/playlist-header-template.html",[],function(){return""}),r("text!templates/playlist-footer-template.html",[],function(){return'<div class="spp-sort-footer">\r\n	<div class="spp-sort"></div>\r\n</div>\r\n<% if ( AP_Player.licensed == true ) { %>\r\n	<div class="spp-playlist-pagination">\r\n		<a href="" class="spp-playlist-prev-page">&lt;</a> <%= data.current_page %> of <%= data.num_pages %> <a href="" class="spp-playlist-next-page">&gt;</a> \r\n	</div>\r\n<% } else { %>\r\n	<div class="spp-logo"></div>\r\n<% } %>\r\n'}),r("text!templates/current-track-template.html",[],function(){return'<div class="spp-current-track-header">\r\n  <div class="spp-track-title-row">\r\n    <h3 class="spp-track-title"><%= title %></h3>\r\n  </div>\r\n\r\n  <div class="spp-progress-row">\r\n    <div class="current-time"><%= current_time %></div>\r\n    <div class="progress-container">\r\n      <div class="progress-icon"></div>\r\n      <div class="progress-bar"></div>\r\n    </div>\r\n    <div class="total-time"><%= duration_time %></div>\r\n  </div>\r\n\r\n  <div class="player-action-row">\r\n    <div class="player-controls">\r\n      <span class="previous-btn"></span>\r\n      <span class="play-pause-btn"></span>\r\n      <span class="next-btn"></span>\r\n    </div>\r\n    <div class="player-download">\r\n      <a href="<%= download_url %>" class="download-btn">Download</a>\r\n      <a href="" class="details-btn">More Details</a>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class="current-track-body">\r\n  <div class="track-show-notes">\r\n    <h4 class="show-notes-header">Show Notes</h4>\r\n    <%= show_notes %>\r\n  </div>\r\n  <div class="track-tags">\r\n    <h4 class="tags-header">Tags</h4>\r\n    <ul class="tag-list"></ul>\r\n  </div>\r\n  <div class="track-share">\r\n    <h4 class="share-header">Share This Episode</h4>\r\n    <a href="" class="share-btn twitter-btn">Twitter</a>\r\n    <a href="" class="share-btn fb-btn">Facebook</a>\r\n    <a href="" class="share-btn gplus-btn">Google+</a>\r\n    <a href="mailto:?subject=<%= show_title %>: <%= encodeURIComponent( title ) %>&amp;body=Hi,%0D%0A%0D%0AI thought you might enjoy this episode of <%= show_title %>:%0D%0A%0D%0A <%= permalink_url %> %0D%0A%0D%0AEnjoy!" class="share-btn email-btn" target="_blank">Email</a>\r\n  </div>\r\n  <div class="track-actions">\r\n    <h4 class="action-header">Actions</h4>\r\n    <a href="<%= download_url %>" class="download-btn">Download</a>\r\n  </div>\r\n</div>\r\n<span id="ap-player-logo"></span>'}),r("apps/smart-podcast-player/core/view",["app","text!templates/spp-template.html","text!templates/player-template.html","text!templates/podcast-track-template.html","text!templates/playlist-template.html","text!templates/playlist-header-template.html","text!templates/playlist-footer-template.html","text!templates/current-track-template.html"],function(e,t){return e.module("AskPatPlayerApp.Core.View",function(e,n,i,r,a,s){e.AP_Player=r.Layout.extend({template:s.template(t),regions:{playerRegion:".spp-player-container",trackDetailsRegion:".spp-track-details-container",playlistRegion:".spp-playlist-container"},onRender:function(){this.$(".spp-player-container").show()}})}),e.AskPatPlayerApp.Core.View}),r("entities/podcast-track",["app"],function(n){n.module("Entities",function(n,i,r,a,s,o){var l=[],u=[],p=[],c=[];n.Player=r.Model.extend({defaults:{data:{}}}),n.Track=r.Model.extend({defaults:{data:{active:!1,artwork_url:"",attachments_uri:"",bpm:null,comment_count:0,commentable:!0,created_at:"",current_time:"0:00:00",description:"",download_count:0,download_url:"",downloadable:!0,download:!0,duration:0,duration_time:"0:00:00",episode_number:0,embeddable_by:"all",email:"",fallback_permalink:"",favoritings_count:0,genre:"",id:0,isrc:"",key_signature:"",kind:"track",label_id:null,label_name:"",license:"",method:"file",original_content_size:0,original_format:"mp3",paid:!1,permalink:"",permalink_url:"",playing:!1,playback_count:0,purchase_title:null,purchase_url:null,release:"",release_day:null,release_month:null,release_year:null,sharing:"",show_name:"",state:"",stream_url:"",streamable:!0,subscription:"",tag_list:"",tags:"",tag_string:"",title:"",track_type:"",uri:"",user:{avatar_url:"",id:0,kind:"user",permalink:"",permalink_url:"",uri:"",username:""},user_id:0,video_url:null,waveform_url:"",show_notes:""}}}),n.Tracks=r.Collection.extend({model:n.Track,comparators:{newest:function(e){return-e.get("id")},oldest:function(e){return e.get("id")},mostPopular:function(e){return-e.get("playback_count")},leastPopular:function(e){return e.get("playback_count")}},setComparator:function(e){return this.comparator=this.comparators[e],this},totalPlaybackCount:function(){return this.reduce(function(e,t){var n=t.get("data");return n.playback_count},0)}});var d=function(i){var r,a=i.model.get("options"),o=i.model.get("region"),u=a.stream,p=new Array,d={action:"get_spplayer_tracks",stream:u};if(s.ajax({url:AP_Player.ajaxurl,dataType:"json",type:"POST",async:!1,data:d,success:function(e){r=e}}),void 0!=r&&null!=r){var h=r.length;s.each(r,function(r,s){var o=/(?:[^\s"]+|"[^"]*")+/g;if(void 0!==s.tag_list&&""!=s.tag_list.trim()){var l=s.tag_list.match(o);l=l.join(",").replace(/\"|\"|\"|\"/g,"").toLowerCase(),s.tag_string=l,l=l.split(","),s.tags=l}else s.tags=new Array;var u=Math.ceil(s.duration/1e3),c=Math.floor(u/60),d=Math.floor(c/60),f=d,m=c%60,g=u%60;if(s.duration_time=f+":"+t(m,2)+":"+t(g,2),s.playing=!1,s.paid=a.paid,void 0!=a.numbering){var v=a.numbering,y=(v.split("#").length-1,new RegExp("[#]{1,10}")),_=v.replace(y,"([0-9]{0,4})"),w=s.title.match(_);w&&(s.episode_number=w[1]);var b=new RegExp(_,"g");s.title_without_episode_number=s.title.replace(b,"")}else s.title_without_episode_number=s.title,s.episode_number=h;s.download=a.download,s.social=a.social,s.social_twitter=a.social_twitter,s.social_facebook=a.social_facebook,s.social_gplus=a.social_gplus,s.social_linkedin=a.social_linkedin,s.social_stumble=a.social_stumble,s.social_pinterest=a.social_pinterest,s.social_email=a.social_email,s.poweredby=a.poweredby,s.speedcontrol=a.speedcontrol,s.show_logo=void 0!==a.show_image?a.show_image:s.artwork_url,s.show_name=a.show_name,s.hashtag=a.hashtag,s.fallback_permalink=void 0!=a.permalink?a.permalink:"",s.email="?subject=",s.email+=void 0!==s.show_name?": "+encodeURIComponent(s.title)+"&amp;body=Hi,%0D%0A%0D%0AI thought you might enjoy this episode of "+s.show_name+":%0D%0A%0D%0A"+s.title+"%0D%0A":": "+encodeURIComponent(s.title)+"&amp;body=Hi,%0D%0A%0D%0AI thought you might enjoy this podcast:%0D%0A%0D%0A"+s.title+"%0D%0A",s.email+=""!=s.permalink_url?s.permalink_url+"%0D%0A%0D%0AEnjoy!":s.fallback_permalink+"%0D%0A%0D%0AEnjoy!",s.method=s.permalink_url.indexOf("soundcloud.com")>0?"soundcloud":"file";
var k=/\n/g;if("soundcloud"==s.method){s.show_notes="<p>"+s.description+"</p>",s.show_notes=e(s.show_notes),s.show_notes=s.show_notes.replace(k,"</p><p>");var C=/<p>\s*<\/p>/g;s.show_notes=s.show_notes.replace(C,"")}else s.show_notes=s.description;void 0!=i.model.attributes.options.subscription&&(s.subscription=i.model.attributes.options.subscription),s.stream_url=s.stream_url.indexOf("&")>-1?s.stream_url.slice(0,s.stream_url.indexOf("&")):s.stream_url;var P={data:s},M=new n.Track(P),T=M.get("data");T.cid=M.cid,M.set({data:T}),p.push(M),h--})}"oldest"==i.model.attributes.options.sort&&p.reverse(),l[o]=new n.Tracks(p),c[o]=p[0]},h=function(e,t,i){var r=e.model.get("region");if(""==i)p[r]=l[r];else{var a=t.filter(function(e){{var t=e.get("data");t.tags}return o.indexOf(t.tags,i)>-1});p[r]=new n.Tracks(a)}return p[r]},f=function(e,t,i,r){var a=e.model.get("region"),o=new Array,l=(i-1)*r,u=i*r;return s.each(t.models,function(e,t){e>=l&&u>e&&o.push(t)}),p[a]=new n.Tracks(o),p[a]},m=function(e){var t=e.model.get("region");void 0===u[t]&&v(e);var n=u[t].find(function(e){var t=e.attributes.data;return t.playing===!0});return n?n:u[t].first()},g=function(e,t){var n=e.find(function(e){var n=e.attributes.data;return n.id===t});return n?n:-1},v=function(e){var t=e.model.get("region");return void 0===u[t]&&(void 0===l[t]&&d(e),u[t]=l[t]),u[t]},y={getTrackEntities:function(e){var t=e.model.get("region");return void 0===l[t]&&d(e),l[t]},getCurrentTrack:function(e){return m(e)},getPagedTracks:function(e,t,n,i){return f(e,t,n,i)},getCurrentTracks:function(e){return v(e)},getTracksByTag:function(e,t,n){var i=e.model.get("region");return p[i]=h(e,t,n),u[i]=p[i],p[i]},setValueAll:function(e,t,n){var i=e.model.get("region");void 0===u[i]&&v(e),l[i].each(function(e){var i=e.get("data");i[t]=n,e.set({data:i})}),u[i].each(function(e){var i=e.get("data");i[t]=n,e.set({data:i})})},setValue:function(e,t,n,i){var r=e.model.get("region");void 0===u[r]&&v(e);var a=g(l[r],t.attributes.data.id),s=g(u[r],t.attributes.data.id),o=u[r].at(u[r].indexOf(s)),p=o.get("data");p[n]=i;var c=(l[r].at(l[r].indexOf(a)),o.get("data"));c[n]=i},setPreviewedTrack:function(e,t){var n=e.model.get("region");c[n]=t},getPreviewedTrack:function(e){var t=e.model.get("region");return c[t]}};i.reqres.setHandler("track:entities",function(e){return y.getTrackEntities(e)}),i.reqres.setHandler("track:entity:current",function(e){return y.getCurrentTrack(e)}),i.reqres.setHandler("track:entities:current",function(e){return y.getCurrentTracks(e)}),i.reqres.setHandler("track:entities:paged",function(e,t,n,i){return y.getPagedTracks(e,t,n,i)}),i.reqres.setHandler("track:entities:tagged",function(e,t,n){return y.getTracksByTag(e,t,n)}),i.reqres.setHandler("track:entities:set",function(e,t,n){y.setValueAll(e,t,n)}),i.reqres.setHandler("track:entity:set",function(e,t,n,i){y.setValue(e,t,n,i)}),i.reqres.setHandler("track:entity:set-previewed",function(e,t){y.setPreviewedTrack(e,t)}),i.reqres.setHandler("track:entity:get-previewed",function(e){return y.getPreviewedTrack(e)})})}),r("entities/podcast-player",["app","entities/podcast-track"],function(e){return e.module("Entities",function(e,t){var n=[],i=function(e){var i=e.model.get("region");n[i]=t.request("track:entity:current",e)},r={getPlayerEntities:function(e){var t=e.model.get("region");return void 0===n[t]&&i(e),n[t]}};t.reqres.setHandler("player:entity",function(e){return r.getPlayerEntities(e)})}),e.Entities}),r("apps/smart-podcast-player/core/controller",["app","apps/smart-podcast-player/core/view","entities/podcast-track","entities/podcast-player","soundmanager2"],function(e,t){return e.module("AskPatPlayerApp.Core",function(e,n,i,r,a){e.Controller={init:function(){a(".smart-podcast-player").length>0&&n.trigger("core:color:setup"),a(".smart-podcast-player").each(function(e,r){var s="SPP_"+e,o=new t.AP_Player({model:new i.Model({region:s,options:{stream:a(r).data("stream"),sort:a(r).data("sort"),show_name:a(r).data("showName"),color:a(r).data("color"),link_color:a(r).data("link_color"),numbering:a(r).data("numbering"),download:a(r).data("download"),subscription:a(r).data("subscription"),show_image:a(r).data("image"),player_uid:a(r).data("uid"),hashtag:a(r).data("hashtag"),social:a(r).data("social"),social_twitter:a(r).data("social_twitter"),social_facebook:a(r).data("social_facebook"),social_gplus:a(r).data("social_gplus"),social_linkedin:a(r).data("social_linkedin"),social_stumble:a(r).data("social_stumble"),social_pinterest:a(r).data("social_pinterest"),social_email:a(r).data("social_email"),poweredby:a(r).data("poweredby"),speedcontrol:a(r).data("speedcontrol"),permalink:a(r).data("permalink"),current_page:1,tracks_per_page:10,paid:a(r).data("paid"),consumer_key:AP_Player.soundcloudConsumerKey}})}),l=new i.Marionette.Region({el:a(r)});n.regions=n.regions?n.regions:{},n[s]=l,n.trigger("playlist:init",o),n.trigger("track-details:init",o),n.trigger("player:init",o),n[s].show(o);var u="?spp_view=1",p=o.model.get("options");u+="&url="+(void 0!=p.stream?p.stream:""),u+="&sort="+(void 0!=p.sort?encodeURIComponent(p.sort):""),u+="&numbering="+(void 0!=p.numbering?encodeURIComponent(p.numbering):""),u+="&download="+(void 0!=p.download?encodeURIComponent(p.download):""),u+="&subscription="+(void 0!=p.subscription?p.subscription:""),u+="&show_name="+(void 0!=p.show_name?encodeURIComponent(p.show_name):""),u+="&image="+(void 0!=p.image?encodeURIComponent(p.image):""),u+="&social="+(void 0!=p.social?encodeURIComponent(p.social):""),u+="&poweredby="+(void 0!=p.poweredby?encodeURIComponent(p.poweredby):""),u+="&speedcontrol="+(void 0!=p.speedcontrol?encodeURIComponent(p.speedcontrol):""),u+="&color="+(void 0!=p.color?encodeURIComponent(p.color):""),u+="&link_color="+(void 0!=p.link_color?encodeURIComponent(p.link_color):""),u+="&subscription="+(void 0!=p.subscription?encodeURIComponent(p.subscription):"")})},setupColors:function(){var e=new Array,t=new Array;a(".smart-podcast-player").each(function(n,i){var r=a(i).attr("class"),s=r.trim().split(/\s+/);a.each(s,function(n,i){var r=i.indexOf("spp-color-");if(r>-1){var s=i.replace("spp-color-","");-1==a.inArray(s,e)&&e.push(s)}var r=i.indexOf("spp-link-color-");if(r>-1){var s=i.replace("spp-link-color-","");-1==a.inArray(s,t)&&t.push(s)}})});var n={action:"get_colors",spp_colors:e,spp_link_colors:t};a.post(AP_Player.ajaxurl,n,function(e){a("head").append(e)})}}}),e.AskPatPlayerApp.Core.Controller}),r("apps/smart-podcast-player/playlist/view",["app","text!templates/podcast-track-template.html","text!templates/playlist-template.html","text!templates/playlist-header-template.html","text!templates/playlist-footer-template.html"],function(e,n,i,r,a){return e.module("AskPatPlayerApp.Playlist.View",function(e,s,o,l,u,p){e.Track=l.ItemView.extend({template:p.template(n),className:"spp-track",triggers:{"click .spp-play":"track:play","click .spp-track-title":"track:preview"},modelEvents:{change:"render"},events:{},initialize:function(){this.spp_elements={spp:null,loaded_container:null,loaded:null,duration:null,position:null,current_time:null};var e=this.model.get("data"),t="track_"+this.model.cid,n=(e.stream_url+"?consumer_key="+AP_Player.soundcloudConsumerKey,soundManager.getSoundById(t));n||this.createSound()},createSound:function(){var e=this,n=this.model.get("data"),i="track_"+this.model.cid,r=n.stream_url+"?consumer_key="+AP_Player.soundcloudConsumerKey;soundManager.createSound({id:i,url:r,hover:!1,onplay:function(){e.spp_elements.spp=null!==e.spp_elements.spp?e.spp_elements.spp:u(e.$el).parents(".smart-podcast-player"),u(e.spp_elements.spp).addClass("spp-playing")},onresume:function(){e.spp_elements.spp=null!==e.spp_elements.spp?e.spp_elements.spp:u(e.$el).parents(".smart-podcast-player"),u(e.spp_elements.spp).addClass("spp-playing")},onpause:function(){e.spp_elements.spp=null!==e.spp_elements.spp?e.spp_elements.spp:u(e.$el).parents(".smart-podcast-player"),u(e.spp_elements.spp).removeClass("spp-playing")},onfinish:function(){e.trigger("track:next")},whileloading:function(){var t=this.bytesLoaded/this.bytesTotal*100+"%";e.spp_elements.spp=null!==e.spp_elements.spp?e.spp_elements.spp:u(e.$el).parents(".smart-podcast-player"),e.spp_elements.loaded_container=null!==e.spp_elements.loaded_container?e.spp_elements.loaded_container:u(e.spp_elements.spp).find(".spp-loaded-container"),e.spp_elements.loaded=null!==e.spp_elements.loaded?e.spp_elements.loaded:u(e.spp_elements.loaded_container).find(".spp-loaded"),u(e.spp_elements.loaded).css({width:t}),this.bytesLoaded/this.bytesTotal>.98&&u(e.spp_elements.loaded_container).fadeOut("slow")},whileplaying:function(){var n,i,r,a,s=this.durationEstimate,o=this.position,l=s-o;n=o/1e3,i=n/60,r=i/60,a=Math.floor(r)+":"+t(Math.floor(i%60),2)+":"+t(Math.floor(n%60),2),n=l/1e3,i=n/60,r=i/60,remaining_time=t(Math.floor(i),2)+":"+t(Math.floor(n%60),2),e.spp_elements.spp=null!==e.spp_elements.spp?e.spp_elements.spp:u(e.$el).parents(".smart-podcast-player"),e.spp_elements.duration=null!==e.spp_elements.duration?e.spp_elements.duration:u(e.spp_elements.spp).find(".spp-duration"),e.spp_elements.current_time=null!==e.spp_elements.current_time?e.spp_elements.current_time:u(e.spp_elements.spp).find(".spp-current-time"),e.spp_elements.position=null!==e.spp_elements.position?e.spp_elements.position:u(e.spp_elements.spp).find(".spp-position"),u(e.spp_elements.duration).text("-"+remaining_time);var p=o/s*100;e.trigger("track:progress:update",p),u(e.spp_elements.current_time).css({width:p+"%"});var c=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);(!u(e.spp_elements.spp).hasClass("hover")||c)&&u(e.spp_elements.position).css({left:p+"%"})}})},onRender:function(){var e=this.model.get("data"),t="track_"+this.model.cid;e.active===!0&&this.$el.addClass("active"),this.$el.attr("data-tid",t)}}),e.Tracks=l.CollectionView.extend({itemView:e.Track,className:"spp-track-list",initialize:function(){var e=this;u(window).on("spp_resize",function(){e.resize()})},resize:function(){this.trigger("resize")}}),e.PlaylistRegion=l.Layout.extend({template:p.template(i),className:"spp-playlist",regions:{headerRegion:".spp-playlist-header",tracksRegion:".spp-playlist-tracks",footerRegion:".spp-playlist-footer"}}),e.PlaylistHeader=l.ItemView.extend({template:p.template(r),className:"spp-playlist-header",initialize:function(){this.render()},triggers:{"click h3 span":"tracks:filter","change .spp-playlist-sorter":"tracks:sort"},events:{"click .spp-playlist-tag":"filterTag"},filterTag:function(e){this.trigger("playlist:filter",u(e.currentTarget).text())}}),e.PlaylistFooter=l.ItemView.extend({template:p.template(a),className:"spp-playlist-footer",triggers:{"click .spp-playlist-next-page":"nav:next-page","click .spp-playlist-prev-page":"nav:prev-page","click .spp-sort":"playlist:sort"},initialize:function(){this.render()}})}),e.AskPatPlayerApp.Playlist.View}),r("entities/playlist",["app","entities/podcast-track"],function(e){return e.module("Entities",function(e,t,n){var i=[],r=[];e.PlaylistHeader=n.Model.extend({defaults:{data:{}}}),e.PlaylistFooter=n.Model.extend({defaults:{data:{}}});var a=function(t){var n=t.model.get("region");i[n]=new e.PlaylistHeader({})},s=function(n){var i=t.request("track:entities",n),a=n.model.get("region"),s=n.model.get("options"),o={current_page:1,num_pages:Math.ceil(i.length/s.tracks_per_page)};r[a]=new e.PlaylistFooter({data:o})},o={getPlaylistHeader:function(e){var t=e.model.get("region");return void 0===i[t]&&a(e),i[t]},getPlaylistFooter:function(e){var t=e.model.get("region");return void 0===r[t]&&s(e),r[t]}};t.reqres.setHandler("playlist:header",function(e){return o.getPlaylistHeader(e)}),t.reqres.setHandler("playlist:footer",function(e){return o.getPlaylistFooter(e)})}),e.Entities}),function(e){function t(){this===r.elem&&(r.pos=[-260,-260],r.elem=!1,a=3)}var n,i,r={pos:[-260,-260]},a=3,s=document,o=s.documentElement,l=s.body;e.event.special.mwheelIntent={setup:function(){var n=e(this).bind("mousewheel",e.event.special.mwheelIntent.handler);return this!==s&&this!==o&&this!==l&&n.bind("mouseleave",t),n=null,!0},teardown:function(){return e(this).unbind("mousewheel",e.event.special.mwheelIntent.handler).unbind("mouseleave",t),!0},handler:function(t){var s=[t.clientX,t.clientY];return this===r.elem||Math.abs(r.pos[0]-s[0])>a||Math.abs(r.pos[1]-s[1])>a?(r.elem=this,r.pos=s,a=250,clearTimeout(i),i=setTimeout(function(){a=10},200),clearTimeout(n),n=setTimeout(function(){a=3},1500),t=e.extend({},t,{type:"mwheelIntent"}),(e.event.dispatch||e.event.handle).apply(this,arguments)):void 0}},e.fn.extend({mwheelIntent:function(e){return e?this.bind("mwheelIntent",e):this.trigger("mwheelIntent")},unmwheelIntent:function(e){return this.unbind("mwheelIntent",e)}}),e(function(){l=s.body,e(s).bind("mwheelIntent.mwheelIntentDefault",e.noop)})}(jQuery),r("mwheel-intent",function(){}),function(e){"function"==typeof r&&r.amd?r("vendor/jquery.mousewheel",["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var s=t||window.event,o=l.call(arguments,1),u=0,p=0,c=0,d=0;if(t=e.event.fix(s),t.type="mousewheel","detail"in s&&(c=-1*s.detail),"wheelDelta"in s&&(c=s.wheelDelta),"wheelDeltaY"in s&&(c=s.wheelDeltaY),"wheelDeltaX"in s&&(p=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(p=-1*c,c=0),u=0===c?p:c,"deltaY"in s&&(c=-1*s.deltaY,u=c),"deltaX"in s&&(p=s.deltaX,0===c&&(u=-1*p)),0!==c||0!==p){if(1===s.deltaMode){var h=e.data(this,"mousewheel-line-height");u*=h,c*=h,p*=h}else if(2===s.deltaMode){var f=e.data(this,"mousewheel-page-height");u*=f,c*=f,p*=f}return d=Math.max(Math.abs(c),Math.abs(p)),(!a||a>d)&&(a=d,i(s,d)&&(a/=40)),i(s,d)&&(u/=40,p/=40,c/=40),u=Math[u>=1?"floor":"ceil"](u/a),p=Math[p>=1?"floor":"ceil"](p/a),c=Math[c>=1?"floor":"ceil"](c/a),t.deltaX=p,t.deltaY=c,t.deltaFactor=a,t.deltaMode=0,o.unshift(t,u,p,c),r&&clearTimeout(r),r=setTimeout(n,200),(e.event.dispatch||e.event.handle).apply(this,o)}}function n(){a=null}function i(e,t){return p.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var r,a,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],o="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var u=s.length;u;)e.event.fixHooks[s[--u]]=e.event.mouseHooks;var p=e.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener)for(var n=o.length;n;)this.addEventListener(o[--n],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",p.getLineHeight(this)),e.data(this,"mousewheel-page-height",p.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=o.length;e;)this.removeEventListener(o[--e],t,!1);else this.onmousewheel=null},getLineHeight:function(t){return parseInt(e(t)["offsetParent"in e.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),!function(e,t,n){e.fn.jScrollPane=function(i){function r(i,r){function a(t){var r,o,u,c,d,h,g=!1,v=!1;if(q=t,V===n)d=i.scrollTop(),h=i.scrollLeft(),i.css({overflow:"hidden",padding:0}),z=i.innerWidth()+_t,U=i.innerHeight(),i.width(z),V=e('<div class="jspPane" />').css("padding",yt).append(i.children()),N=e('<div class="jspContainer" />').css({width:z+"px",height:U+"px"}).append(V).appendTo(i);else{if(i.css("width",""),g=q.stickToBottom&&O(),v=q.stickToRight&&A(),c=i.innerWidth()+_t!=z||i.outerHeight()!=U,c&&(z=i.innerWidth()+_t,U=i.innerHeight(),N.css({width:z+"px",height:U+"px"})),!c&&wt==W&&V.outerHeight()==X)return void i.width(z);wt=W,V.css("width",""),i.width(z),N.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}V.css("overflow","auto"),W=t.contentWidth?t.contentWidth:V[0].scrollWidth,X=V[0].scrollHeight,V.css("overflow",""),Y=W/z,Q=X/U,J=Q>1,G=Y>1,G||J?(i.addClass("jspScrollable"),r=q.maintainPosition&&(et||it),r&&(o=T(),u=x()),s(),l(),p(),r&&(P(v?W-z:o,!1),C(g?X-U:u,!1)),E(),j(),F(),q.enableKeyboardNavigation&&$(),q.clickOnTrack&&f(),H(),q.hijackInternalLinks&&D()):(i.removeClass("jspScrollable"),V.css({top:0,left:0,width:N.width()-_t}),I(),R(),L(),m()),q.autoReinitialise&&!vt?vt=setInterval(function(){a(q)},q.autoReinitialiseDelay):!q.autoReinitialise&&vt&&clearInterval(vt),d&&i.scrollTop(0)&&C(d,!1),h&&i.scrollLeft(0)&&P(h,!1),i.trigger("jsp-initialised",[G||J])}function s(){J&&(N.append(e('<div class="jspVerticalBar" />').append(e('<div class="jspCap jspCapTop" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragTop" />'),e('<div class="jspDragBottom" />'))),e('<div class="jspCap jspCapBottom" />'))),rt=N.find(">.jspVerticalBar"),at=rt.find(">.jspTrack"),K=at.find(">.jspDrag"),q.showArrows&&(ut=e('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",d(0,-1)).bind("click.jsp",S),pt=e('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",d(0,1)).bind("click.jsp",S),q.arrowScrollOnHover&&(ut.bind("mouseover.jsp",d(0,-1,ut)),pt.bind("mouseover.jsp",d(0,1,pt))),c(at,q.verticalArrowPositions,ut,pt)),ot=U,N.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){ot-=e(this).outerHeight()}),K.hover(function(){K.addClass("jspHover")},function(){K.removeClass("jspHover")}).bind("mousedown.jsp",function(t){e("html").bind("dragstart.jsp selectstart.jsp",S),K.addClass("jspActive");var n=t.pageY-K.position().top;return e("html").bind("mousemove.jsp",function(e){v(e.pageY-n,!1)}).bind("mouseup.jsp mouseleave.jsp",g),!1}),o())}function o(){at.height(ot+"px"),et=0,st=q.verticalGutter+at.outerWidth(),V.width(z-st-_t);try{0===rt.position().left&&V.css("margin-left",st+"px")}catch(e){}}function l(){G&&(N.append(e('<div class="jspHorizontalBar" />').append(e('<div class="jspCap jspCapLeft" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragLeft" />'),e('<div class="jspDragRight" />'))),e('<div class="jspCap jspCapRight" />'))),ct=N.find(">.jspHorizontalBar"),dt=ct.find(">.jspTrack"),tt=dt.find(">.jspDrag"),q.showArrows&&(mt=e('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",d(-1,0)).bind("click.jsp",S),gt=e('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",d(1,0)).bind("click.jsp",S),q.arrowScrollOnHover&&(mt.bind("mouseover.jsp",d(-1,0,mt)),gt.bind("mouseover.jsp",d(1,0,gt))),c(dt,q.horizontalArrowPositions,mt,gt)),tt.hover(function(){tt.addClass("jspHover")},function(){tt.removeClass("jspHover")}).bind("mousedown.jsp",function(t){e("html").bind("dragstart.jsp selectstart.jsp",S),tt.addClass("jspActive");var n=t.pageX-tt.position().left;return e("html").bind("mousemove.jsp",function(e){_(e.pageX-n,!1)}).bind("mouseup.jsp mouseleave.jsp",g),!1}),ht=N.innerWidth(),u())}function u(){N.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){ht-=e(this).outerWidth()}),dt.width(ht+"px"),it=0}function p(){if(G&&J){var t=dt.outerHeight(),n=at.outerWidth();ot-=t,e(ct).find(">.jspCap:visible,>.jspArrow").each(function(){ht+=e(this).outerWidth()}),ht-=n,U-=n,z-=t,dt.parent().append(e('<div class="jspCorner" />').css("width",t+"px")),o(),u()}G&&V.width(N.outerWidth()-_t+"px"),X=V.outerHeight(),Q=X/U,G&&(ft=Math.ceil(1/Y*ht),ft>q.horizontalDragMaxWidth?ft=q.horizontalDragMaxWidth:ft<q.horizontalDragMinWidth&&(ft=q.horizontalDragMinWidth),tt.width(ft+"px"),nt=ht-ft,w(it)),J&&(lt=Math.ceil(1/Q*ot),lt>q.verticalDragMaxHeight?lt=q.verticalDragMaxHeight:lt<q.verticalDragMinHeight&&(lt=q.verticalDragMinHeight),K.height(lt+"px"),Z=ot-lt,y(et))}function c(e,t,n,i){var r,a="before",s="after";"os"==t&&(t=/Mac/.test(navigator.platform)?"after":"split"),t==a?s=t:t==s&&(a=t,r=n,n=i,i=r),e[a](n)[s](i)}function d(e,t,n){return function(){return h(e,t,this,n),this.blur(),!1}}function h(t,n,i,r){i=e(i).addClass("jspActive");var a,s,o=!0,l=function(){0!==t&&bt.scrollByX(t*q.arrowButtonSpeed),0!==n&&bt.scrollByY(n*q.arrowButtonSpeed),s=setTimeout(l,o?q.initialDelay:q.arrowRepeatFreq),o=!1};l(),a=r?"mouseout.jsp":"mouseup.jsp",r=r||e("html"),r.bind(a,function(){i.removeClass("jspActive"),s&&clearTimeout(s),s=null,r.unbind(a)})}function f(){m(),J&&at.bind("mousedown.jsp",function(t){if(t.originalTarget===n||t.originalTarget==t.currentTarget){var i,r=e(this),a=r.offset(),s=t.pageY-a.top-et,o=!0,l=function(){var e=r.offset(),n=t.pageY-e.top-lt/2,a=U*q.scrollPagePercent,p=Z*a/(X-U);if(0>s)et-p>n?bt.scrollByY(-a):v(n);else{if(!(s>0))return void u();n>et+p?bt.scrollByY(a):v(n)}i=setTimeout(l,o?q.initialDelay:q.trackClickRepeatFreq),o=!1},u=function(){i&&clearTimeout(i),i=null,e(document).unbind("mouseup.jsp",u)};return l(),e(document).bind("mouseup.jsp",u),!1}}),G&&dt.bind("mousedown.jsp",function(t){if(t.originalTarget===n||t.originalTarget==t.currentTarget){var i,r=e(this),a=r.offset(),s=t.pageX-a.left-it,o=!0,l=function(){var e=r.offset(),n=t.pageX-e.left-ft/2,a=z*q.scrollPagePercent,p=nt*a/(W-z);if(0>s)it-p>n?bt.scrollByX(-a):_(n);else{if(!(s>0))return void u();n>it+p?bt.scrollByX(a):_(n)}i=setTimeout(l,o?q.initialDelay:q.trackClickRepeatFreq),o=!1},u=function(){i&&clearTimeout(i),i=null,e(document).unbind("mouseup.jsp",u)};return l(),e(document).bind("mouseup.jsp",u),!1}})}function m(){dt&&dt.unbind("mousedown.jsp"),at&&at.unbind("mousedown.jsp")}function g(){e("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),K&&K.removeClass("jspActive"),tt&&tt.removeClass("jspActive")}function v(e,t){J&&(0>e?e=0:e>Z&&(e=Z),t===n&&(t=q.animateScroll),t?bt.animate(K,"top",e,y):(K.css("top",e),y(e)))}function y(e){e===n&&(e=K.position().top),N.scrollTop(0),et=e;var t=0===et,r=et==Z,a=e/Z,s=-a*(X-U);(kt!=t||Pt!=r)&&(kt=t,Pt=r,i.trigger("jsp-arrow-change",[kt,Pt,Ct,Mt])),b(t,r),V.css("top",s),i.trigger("jsp-scroll-y",[-s,t,r]).trigger("scroll")}function _(e,t){G&&(0>e?e=0:e>nt&&(e=nt),t===n&&(t=q.animateScroll),t?bt.animate(tt,"left",e,w):(tt.css("left",e),w(e)))}function w(e){e===n&&(e=tt.position().left),N.scrollTop(0),it=e;var t=0===it,r=it==nt,a=e/nt,s=-a*(W-z);(Ct!=t||Mt!=r)&&(Ct=t,Mt=r,i.trigger("jsp-arrow-change",[kt,Pt,Ct,Mt])),k(t,r),V.css("left",s),i.trigger("jsp-scroll-x",[-s,t,r]).trigger("scroll")}function b(e,t){q.showArrows&&(ut[e?"addClass":"removeClass"]("jspDisabled"),pt[t?"addClass":"removeClass"]("jspDisabled"))}function k(e,t){q.showArrows&&(mt[e?"addClass":"removeClass"]("jspDisabled"),gt[t?"addClass":"removeClass"]("jspDisabled"))}function C(e,t){var n=e/(X-U);v(n*Z,t)}function P(e,t){var n=e/(W-z);_(n*nt,t)}function M(t,n,i){var r,a,s,o,l,u,p,c,d,h=0,f=0;try{r=e(t)}catch(m){return}for(a=r.outerHeight(),s=r.outerWidth(),N.scrollTop(0),N.scrollLeft(0);!r.is(".jspPane");)if(h+=r.position().top,f+=r.position().left,r=r.offsetParent(),/^body|html$/i.test(r[0].nodeName))return;o=x(),u=o+U,o>h||n?c=h-q.horizontalGutter:h+a>u&&(c=h-U+a+q.horizontalGutter),isNaN(c)||C(c,i),l=T(),p=l+z,l>f||n?d=f-q.horizontalGutter:f+s>p&&(d=f-z+s+q.horizontalGutter),isNaN(d)||P(d,i)}function T(){return-V.position().left}function x(){return-V.position().top}function O(){var e=X-U;return e>20&&e-x()<10}function A(){var e=W-z;return e>20&&e-T()<10}function j(){N.unbind(xt).bind(xt,function(e,t,n,i){var r=it,a=et,s=e.deltaFactor||q.mouseWheelSpeed;return bt.scrollBy(n*s,-i*s,!1),r==it&&a==et})}function I(){N.unbind(xt)}function S(){return!1}function E(){V.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(e){M(e.target,!1)})}function R(){V.find(":input,a").unbind("focus.jsp")}function $(){function t(){var e=it,t=et;switch(n){case 40:bt.scrollByY(q.keyboardSpeed,!1);break;case 38:bt.scrollByY(-q.keyboardSpeed,!1);break;case 34:case 32:bt.scrollByY(U*q.scrollPagePercent,!1);break;case 33:bt.scrollByY(-U*q.scrollPagePercent,!1);break;case 39:bt.scrollByX(q.keyboardSpeed,!1);break;case 37:bt.scrollByX(-q.keyboardSpeed,!1)}return r=e!=it||t!=et}var n,r,a=[];G&&a.push(ct[0]),J&&a.push(rt[0]),V.focus(function(){i.focus()}),i.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(i){if(i.target===this||a.length&&e(i.target).closest(a).length){var s=it,o=et;switch(i.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:n=i.keyCode,t();break;case 35:C(X-U),n=null;break;case 36:C(0),n=null}return r=i.keyCode==n&&s!=it||o!=et,!r}}).bind("keypress.jsp",function(e){return e.keyCode==n&&t(),!r}),q.hideFocus?(i.css("outline","none"),"hideFocus"in N[0]&&i.attr("hideFocus",!0)):(i.css("outline",""),"hideFocus"in N[0]&&i.attr("hideFocus",!1))}function L(){i.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function H(){if(location.hash&&location.hash.length>1){var t,n,i=escape(location.hash.substr(1));try{t=e("#"+i+', a[name="'+i+'"]')}catch(r){return}t.length&&V.find(i)&&(0===N.scrollTop()?n=setInterval(function(){N.scrollTop()>0&&(M(t,!0),e(document).scrollTop(N.position().top),clearInterval(n))},50):(M(t,!0),e(document).scrollTop(N.position().top)))}}function D(){e(document.body).data("jspHijack")||(e(document.body).data("jspHijack",!0),e(document.body).delegate("a[href*=#]","click",function(n){var i,r,a,s,o,l,u=this.href.substr(0,this.href.indexOf("#")),p=location.href;if(-1!==location.href.indexOf("#")&&(p=location.href.substr(0,location.href.indexOf("#"))),u===p){i=escape(this.href.substr(this.href.indexOf("#")+1));try{r=e("#"+i+', a[name="'+i+'"]')}catch(c){return}r.length&&(a=r.closest(".jspScrollable"),s=a.data("jsp"),s.scrollToElement(r,!0),a[0].scrollIntoView&&(o=e(t).scrollTop(),l=r.offset().top,(o>l||l>o+e(t).height())&&a[0].scrollIntoView()),n.preventDefault())}}))}function F(){var e,t,n,i,r,a=!1;N.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(s){var o=s.originalEvent.touches[0];e=T(),t=x(),n=o.pageX,i=o.pageY,r=!1,a=!0}).bind("touchmove.jsp",function(s){if(a){var o=s.originalEvent.touches[0],l=it,u=et;return bt.scrollTo(e+n-o.pageX,t+i-o.pageY),r=r||Math.abs(n-o.pageX)>5||Math.abs(i-o.pageY)>5,l==it&&u==et}}).bind("touchend.jsp",function(){a=!1}).bind("click.jsp-touchclick",function(){return r?(r=!1,!1):void 0})}function B(){var e=x(),t=T();i.removeClass("jspScrollable").unbind(".jsp"),i.replaceWith(Tt.append(V.children())),Tt.scrollTop(e),Tt.scrollLeft(t),vt&&clearInterval(vt)}var q,V,z,U,N,W,X,Y,Q,J,G,K,Z,et,tt,nt,it,rt,at,st,ot,lt,ut,pt,ct,dt,ht,ft,mt,gt,vt,yt,_t,wt,bt=this,kt=!0,Ct=!0,Pt=!1,Mt=!1,Tt=i.clone(!1,!1).empty(),xt=e.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";"border-box"===i.css("box-sizing")?(yt=0,_t=0):(yt=i.css("paddingTop")+" "+i.css("paddingRight")+" "+i.css("paddingBottom")+" "+i.css("paddingLeft"),_t=(parseInt(i.css("paddingLeft"),10)||0)+(parseInt(i.css("paddingRight"),10)||0)),e.extend(bt,{reinitialise:function(t){t=e.extend({},q,t),a(t)},scrollToElement:function(e,t,n){M(e,t,n)},scrollTo:function(e,t,n){P(e,n),C(t,n)},scrollToX:function(e,t){P(e,t)},scrollToY:function(e,t){C(e,t)},scrollToPercentX:function(e,t){P(e*(W-z),t)},scrollToPercentY:function(e,t){C(e*(X-U),t)},scrollBy:function(e,t,n){bt.scrollByX(e,n),bt.scrollByY(t,n)},scrollByX:function(e,t){var n=T()+Math[0>e?"floor":"ceil"](e),i=n/(W-z);_(i*nt,t)},scrollByY:function(e,t){var n=x()+Math[0>e?"floor":"ceil"](e),i=n/(X-U);v(i*Z,t)},positionDragX:function(e,t){_(e,t)},positionDragY:function(e,t){v(e,t)},animate:function(e,t,n,i){var r={};r[t]=n,e.animate(r,{duration:q.animateDuration,easing:q.animateEase,queue:!1,step:i})},getContentPositionX:function(){return T()},getContentPositionY:function(){return x()},getContentWidth:function(){return W},getContentHeight:function(){return X},getPercentScrolledX:function(){return T()/(W-z)},getPercentScrolledY:function(){return x()/(X-U)},getIsScrollableH:function(){return G},getIsScrollableV:function(){return J},getContentPane:function(){return V},scrollToBottom:function(e){v(Z,e)},hijackInternalLinks:e.noop,destroy:function(){B()}}),a(r)}return i=e.extend({},e.fn.jScrollPane.defaults,i),e.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){i[this]=i[this]||i.speed}),this.each(function(){var t=e(this),n=t.data("jsp");n?n.reinitialise(i):(e("script",t).filter('[type="text/javascript"],:not([type])').remove(),n=new r(t,i),t.data("jsp",n))})},e.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:n,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}(jQuery,this),r("vendor/jquery.jscrollpane.min",function(){}),r("apps/smart-podcast-player/playlist/controller",["app","apps/smart-podcast-player/playlist/view","entities/podcast-track","entities/playlist","vendor/jquery.jscrollpane.min","vendor/jquery.mousewheel"],function(e,t){return e.module("AskPatPlayerApp.Playlist",function(e,n,i,r,a){var s=[],o=[],l=[],u=[],p=[],c=[],d=[],h=[],f=[];e.Controller={init:function(e){var i=e.model.get("region"),r=e.model.get("options");s[i]=void 0===s[i]?n.request("track:entities",e):s[i],o[i]=void 0===o[i]?n.request("track:entities:current",e):o[i],l[i]=void 0===l[i]?n.request("track:entities:paged",e,o[i],r.current_page,r.tracks_per_page):l[i],u[i]=void 0===u[i]?[]:u[i],p[i]=n.request("playlist:header",e),c[i]=n.request("playlist:footer",e);var m=new t.PlaylistRegion({}),g=new t.Tracks({collection:l[i]}),v=new t.PlaylistHeader({model:p[i]}),y=new t.PlaylistFooter({model:c[i]});m.on("show",function(){m.headerRegion.show(v),m.tracksRegion.show(g),m.footerRegion.show(y)}),v.on("playlist:filter",function(t){t=t.replace("×",""),n.trigger("playlist:filter",e,t)}),v.on("show",function(){this.$el.addClass("spp-empty")}),g.on("resize",function(){g.$el.removeData("jsp").removeClass("jspScrollable"),g.$(".jspContainer").remove(),g.$el.attr("style",""),this.render()}),g.on("show",function(){window.innerWidth>768&&this.$el.jScrollPane()}),g.on("playlist:sort",function(){var t=o[i].models;o[i].models=t.reverse();var a=n.request("track:entity:get-previewed",e),s=o[i].indexOf(a),u=Math.floor(s/r.tracks_per_page)+1,p=Math.ceil(o[i].length/r.tracks_per_page);r.current_page=1>u||u>p?1:u,l[i]=n.request("track:entities:paged",e,o[i],r.current_page,r.tracks_per_page),g.collection=l[i],g.render(),y.model.attributes.data.current_page=r.current_page,y.render()}),g.on("render",function(){var e=v.$el.outerHeight();window.innerWidth>768?(this.$el.height(449-e),this.$el.jScrollPane()):this.$el.height("auto")}),g.on("itemview:track:loading",function(e,t){var n=(a(".spp-loaded-container"),a(".spp-loaded"));a(n).width(t)}),g.on("itemview:track:next",function(){o[i]=n.request("track:entities:current",e);var t=n.request("track:entity:current",e);t||(t=o[i].first());var r=o[i].indexOf(t),a=r<o[i].length-1?r+1:0;n.trigger("player:track:play",e,o[i].at(a))}),g.on("itemview:track:play",function(t){n.trigger("player:track:play",e,t.model)}),g.on("itemview:track:preview",function(t){n.trigger("track-details:show",e,t.model),n.request("track:entity:set-previewed",e,t.model)}),g.on("before:render",function(){g.$el.removeData("jsp").removeClass("jspScrollable"),g.$(".jspContainer").remove()}),g.on("paging:next",function(){o[i]=n.request("track:entities:current",e);var t=Math.ceil(o[i].length/r.tracks_per_page);n.request("track:entities:current",e),r.current_page<t&&(r.current_page=r.current_page+1,l[i]=n.request("track:entities:paged",e,o[i],r.current_page,r.tracks_per_page),g.collection=l[i],g.render()),y.model.attributes.data.current_page=r.current_page,y.render()
}),g.on("paging:prev",function(){o[i]=n.request("track:entities:current",e);Math.ceil(o[i].length/r.tracks_per_page);r.current_page>1&&(r.current_page=r.current_page-1,l[i]=n.request("track:entities:paged",e,o[i],r.current_page,r.tracks_per_page),g.collection=l[i],g.render()),y.model.attributes.data.current_page=r.current_page,y.render()}),g.on("paging:goto:track",function(t){o[i]=n.request("track:entities:current",e);var a=(Math.ceil(o[i].length/r.tracks_per_page),o[i].indexOf(t)),s=a+1<o[i].length?a+1:0,u=Math.ceil(s/r.tracks_per_page);r.current_page!=u&&(r.current_page=u,l[i]=n.request("track:entities:paged",e,o[i],r.current_page,r.tracks_per_page),g.collection=l[i],g.render()),y.model.attributes.data.current_page=r.current_page,y.render(),n.trigger("player:track:play",e,t)}),g.on("paging:update",function(){s[i].invoke("set",{playing:!1}),o[i]=n.request("track:entities:current",e);var t=r.current_page,a=r.tracks_per_page,u=n.request("track:entity:current",e);u||(u=o[i].first());var p=o[i].indexOf(u),c=Math.ceil((p+1)/a);c!=t&&(r.current_page=c>0?c:1,l[i]=n.request("track:entities:paged",e,o[i],r.current_page,r.tracks_per_page),g.collection=l[i],g.render(),y.model.attributes.data.current_page=r.current_page,y.render())}),y.on("playlist:sort",function(){g.trigger("playlist:sort"),this.$(".spp-sort").toggleClass("spp-sort-reverse")}),y.on("nav:next-page",function(){g.trigger("paging:next")}),y.on("nav:prev-page",function(){g.trigger("paging:prev")}),y.on("render",function(){var t=e.model.get("options");o[i]=n.request("track:entities:current",e);var r=Math.ceil(o[i].length/t.tracks_per_page);1==t.current_page?a(".spp-playlist-prev-page").addClass("spp-disabled"):a(".spp-playlist-prev-page").removeClass("spp-disabled"),t.current_page==r?a(".spp-playlist-next-page").addClass("spp-disabled"):a(".spp-playlist-next-page").removeClass("spp-disabled")}),y.on("show",function(){var t=e.model.get("options");o[i]=n.request("track:entities:current",e);var r=Math.ceil(o[i].length/t.tracks_per_page);1==t.current_page?this.$(".spp-playlist-prev-page").addClass("spp-disabled"):this.$(".spp-playlist-prev-page").removeClass("spp-disabled"),t.current_page==r?this.$(".spp-playlist-next-page").addClass("spp-disabled"):this.$(".spp-playlist-next-page").removeClass("spp-disabled")}),d[i]=g,h[i]=v,f[i]=y,e.playlistRegion.show(m)},gotoPlaylistTrackPage:function(e,t){var n=e.model.get("region");d[n].trigger("paging:goto:track",t)},updatePaging:function(e){var t=e.model.get("region");d[t].trigger("paging:update")},filter:function(e,t){var i=e.model.get("region"),r=e.model.get("options"),s=a.inArray(t,u[i]);if("-1"==s?u[i].push(t):u[i].splice(s,1),u[i].length<1){h[i].$el.html("").addClass("spp-empty"),o[i]=n.request("track:entities",e),o[i]=n.request("track:entities:tagged",e,o[i],"");{Math.ceil(o[i].length/r.tracks_per_page)}l[i]=n.request("track:entities:paged",e,o[i],1,r.tracks_per_page);var p=Math.ceil(o[i].length/r.tracks_per_page);d[i].collection=l[i],d[i].render(),r.current_page=f[i].model.attributes.data.current_page=1,f[i].model.attributes.data.num_pages=p,f[i].render()}else{var c="";a.each(u[i],function(e,t){c+='<span class="spp-playlist-tag">'+t+'<span class="spp-remove-tag">&times;</span></span>'}),h[i].$el.html(c).removeClass("spp-empty"),o[i]=n.request("track:entities",e),a.each(u[i],function(t,r){o[i]=n.request("track:entities:tagged",e,o[i],r)});{Math.ceil(o[i].length/r.tracks_per_page)}l[i]=n.request("track:entities:paged",e,o[i],1,r.tracks_per_page),o[i]=n.request("track:entities:current",e);var p=Math.ceil(o[i].length/r.tracks_per_page);d[i].collection=l[i],d[i].render(),r.current_page=f[i].model.attributes.data.current_page=1,f[i].model.attributes.data.num_pages=p,f[i].render()}}}}),e.AskPatPlayerApp.Playlist.Controller}),r("text!templates/track-details-template.html",[],function(){return'<div class="spp-track-details-header">\r\n  <a href="" class="spp-currently-playing"><span>&lt;</span> Currently Playing</a>\r\n  <h3 class="spp-track-details-title"><%= data.title %></h3>\r\n  <% var adl = document.createElement(\'a\'); %>\r\n  <% var adloff = /Firefox/i.test(navigator.userAgent); %>\r\n  <% if ( data.download == true && (typeof adl.download != "undefined") && (!adloff) && data.method != \'soundcloud\' ) { %><a class="spp-button spp-button-downloada" href="<%= data.download_url %>" download="<%= data.filename %>">Download</a><% } %>\r\n     <% if ( data.download == true && (typeof adl.download == "undefined" || (adloff) || data.method == \'soundcloud\' ) ) { %><a class="spp-button spp-button-download" href="<%= data.download_url %>" target="_blank">Download</a><% } %>\r\n  <% if ( data.subscription != \'\' ) { %><a class="spp-button spp-button-subscribe" href="<%= data.subscription %>" target="_blank">Subscribe</a><% } %>\r\n</div>\r\n\r\n<div class="spp-track-details-body">\r\n  \r\n  <% if ( data.social == true ) { %>\r\n    <div class="spp-track-details-share">\r\n      <% if ( data.social_twitter == true ) { %>\r\n          <a href="" class="spp-share-btn spp-twitter">Twitter</a>\r\n      <% } %>    \r\n      <% if ( data.social_facebook == true ) { %>\r\n          <a href="" class="spp-share-btn spp-facebook">Facebook</a>\r\n      <% } %>    \r\n      <% if ( data.social_gplus == true ) { %>\r\n          <a href="" class="spp-share-btn spp-gplus">Google+</a>\r\n      <% } %>    \r\n      <% if ( data.social_linkedin == true ) { %>\r\n          <a href="" class="spp-share-btn spp-linkedin">LinkedIn</a>\r\n      <% } %>    \r\n      <% if ( data.social_stumble == true ) { %>\r\n          <a href="" class="spp-share-btn spp-stumble">StumbleUpon</a>\r\n      <% } %>    \r\n      <% if ( data.social_pinterest == true ) { %>\r\n          <a href="" class="spp-share-btn spp-pinterest">Pinterest</a>\r\n      <% } %>    \r\n      <% if ( data.social_email == true ) { %>\r\n          <a href="mailto:<%= data.email %>" class="spp-share-btn spp-email" target="_blank">Email</a>\r\n      <% } %> \r\n    </div>\r\n  <% } %>    \r\n  \r\n  <div class="spp-track-details-show-notes">\r\n    <%= data.show_notes %>\r\n  </div>\r\n\r\n  <div class="spp-track-details-tags">\r\n    <ul class="spp-tag-list"></ul>\r\n  </div>\r\n\r\n<% if ( data.poweredby == true ) { %>\r\n  <div class="spp-track-details-footer">\r\n    <span class="spp-brand-mark">Powered by the <strong><a href="https://smartpodcastplayer.com/" target="_blank">Smart Podcast Player</a></strong></span>  \r\n  </div>\r\n<% } %>\r\n\r\n  <iframe class="spp-downloader" style="display:none"></iframe>\r\n  \r\n</div>\r\n'}),r("apps/smart-podcast-player/track-details/view",["app","text!templates/track-details-template.html"],function(e,t){return e.module("AskPatPlayerApp.TrackDetails.View",function(e,n,i,r,a,s){e.TrackDetails=r.Layout.extend({template:s.template(t),className:"spp-track-details",triggers:{"click .spp-play-pause-btn":"play","click .spp-button-download":"track:download","click .spp-previous-btn":"track:previous","click .spp-next-btn":"track:next","click .spp-currently-playing":"track:current","click .details-btn":"content:toggle"},events:{"click .spp-player-tag":"filterTag","click .spp-progress-container":"seek","click .spp-share-btn":"share"},initialize:function(){var e=this;a(window).on("spp_resize",function(){e.resize()})},resize:function(){this.trigger("resize")},socialPopup:function(e,t){window.open(t,"pinterest","screenX=100,screenY=100,height=360,width=730"),e.preventDefault(),e.stopPropagation()},share:function(e){var t=this,n=t.model.get("data"),i=a(e.currentTarget),r=""!=n.fallback_permalink&&null!=n.fallback_permalink&&void 0!=n.fallback_permalink?n.fallback_permalink:""!=n.permalink_url?n.permalink_url:"";if(i.hasClass("spp-facebook")&&this.socialPopup(e,"http://www.facebook.com/sharer/sharer.php?m2w&s=100&p[url]="+encodeURIComponent(r)+"&p[images][0]=&p[title]="+encodeURIComponent(n.title)),i.hasClass("spp-twitter")){var s="url="+encodeURIComponent(r)+"&text="+encodeURIComponent(n.title);""!=n.hashtag&&void 0!=n.hashtag&&(s=s+" "+encodeURIComponent("#"+n.hashtag)),this.socialPopup(e,"https://twitter.com/intent/tweet?"+s)}i.hasClass("spp-gplus")&&this.socialPopup(e,"https://plus.google.com/share?url="+encodeURIComponent(r)),i.hasClass("spp-stumble")&&this.socialPopup(e,"http://www.stumbleupon.com/submit?url="+encodeURIComponent(r)+"&title="+encodeURIComponent(n.title)),i.hasClass("spp-pinterest")&&this.socialPopup(e,"https://pinterest.com/pin/create/button/?url="+encodeURIComponent(r)),i.hasClass("spp-linkedin")&&this.socialPopup(e,"https://www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(r)+"&title="+encodeURIComponent(n.title))},seek:function(e){function t(){n.bytesLoaded/n.bytesTotal>p&&(n.pause(),n.setPosition(p*l),n.spp-play(),clearInterval(u))}var n=soundManager.getSoundById("track_"+this.model.get("id")),i=e.offsetX,r=e.offsetY,s=a(e.currentTarget).width(),o=n.spp-o,l=this.model.get("duration");void 0==i&&(i=e.pageX-this.$(".spp-progress-container").offset().left),void 0==r&&(r=e.pageY-this.$(".spp-progress-container").offset().top);var u,p=i/s;if(n.bytesLoaded/n.bytesTotal>p)n.pause(),n.setPosition(p*l),n.spp-play();else{this.$el.hasClass("playing")||n.spp-play(),n.pause();var c=100*p+"%";a(e.currentTarget).find(".spp-progress-icon").css({left:c}),u=setInterval(t,250)}},filterTag:function(e){this.trigger("playlist:filter",this,a(e.currentTarget).text())},onRender:function(){var e=this.model.get("data"),t=e.tags,n="";a.each(t,function(e,t){n+='<li class="spp-player-tag">'+t+"</li>"}),this.$(".spp-tag-list").html(n)}})}),e.AskPatPlayerApp.TrackDetails.View}),r("apps/smart-podcast-player/track-details/controller",["app","apps/smart-podcast-player/track-details/view","entities/podcast-track","soundmanager2","vendor/jquery.jscrollpane.min","vendor/jquery.mousewheel"],function(e,t){return e.module("AskPatPlayerApp.TrackDetails",function(e,n,i,r,a){var s=[];e.Controller={init:function(e){var i=e.model.get("region"),r=(e.model.get("options"),n.request("track:entity:current",e)),o=new t.TrackDetails({model:r});o.on("show",function(){window.innerWidth>768&&o.$el.jScrollPane()}),o.on("playlist:filter",function(t,i){n.trigger("playlist:filter",e,i)}),o.on("resize",function(){window.innerWidth>768&&a(".spp-player .spp-track-details-container").show(),o.$el.removeData("jsp").removeClass("jspScrollable"),o.$el.attr("style","").attr("tabindex",""),o.$(".jspContainer").remove(),o.render(),window.innerWidth>768&&o.$el.jScrollPane()}),o.on("track:download",function(e){var t=e.model.get("data"),n=t.download_url,i=t.download_id;"https:"===location.protocol&&(n=n.replace(/^http:\/\//i,"https://"));var r=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(r||"soundcloud"==t.method&&"http:"!==location.protocol)window.location=n+"?consumer_key="+AP_Player.soundcloudConsumerKey;else{if("soundcloud"==t.method)var a=n+"?consumer_key="+AP_Player.soundcloudConsumerKey;else var a=AP_Player.homeUrl+"/?spp_download="+i;e.view.$(".spp-downloader").prop("src",a)}}),o.on("track:current",function(){var t=n.request("track:entity:current",e);o.$el.removeData("jsp").removeClass("jspScrollable"),o.$el.attr("style","").attr("tabindex",""),o.$(".jspContainer").remove(),this.model=t,this.render(),window.innerWidth>768&&this.$el.jScrollPane()}),o.on("render",function(){o.$el.removeClass("spp-current"),window.innerWidth>768?o.$el.jScrollPane():(o.$el.removeData("jsp").removeClass("jspScrollable"),o.$el.attr("style","").attr("tabindex",""),o.$(".jspContainer").remove());var t=n.request("track:entity:current",e);t.attributes.data.id===o.model.attributes.data.id&&o.$el.addClass("spp-current")}),e.trackDetailsRegion.show(o),s[i]=o},show:function(e,t){var n=e.model.get("region"),i=s[n];i.$el.removeData("jsp").removeClass("jspScrollable"),i.$el.attr("style","").attr("tabindex",""),i.$(".jspContainer").remove(),i.model=t,i.render(),window.innerWidth>768&&i.$el.jScrollPane()}}}),e.AskPatPlayerApp.TrackDetails.Controller}),r("apps/smart-podcast-player/player/view",["app","text!templates/player-template.html"],function(e,t){return e.module("AskPatPlayerApp.Player.View",function(e,n,i,r,a,s){e.Player=r.ItemView.extend({template:s.template(t),className:"spp-player",triggers:{"click .spp-play":"track:play","click .spp-next":"track:next","click .spp-previous":"track:previous","click .spp-speed":"track:speed","click .spp-show-notes-button":"track:show-notes"},events:{"mousemove .spp-track":"cursorMove","mouseout .spp-track":"cursorOut","click .spp-track":"seek"},initialize:function(){this.hover=!1;var e=this;a(window).on("spp_resize",function(){e.resize()})},resize:function(){this.trigger("resize")},seek:function(e){this.trigger("track:seek",e)},cursorMove:function(e){this.trigger("cursor:move",e)},cursorOut:function(e){this.trigger("cursor:out",e)},onRender:function(){}})}),e.AskPatPlayerApp.Player.View}),r("apps/smart-podcast-player/player/controller",["app","apps/smart-podcast-player/player/view","entities/podcast-player","entities/podcast-track","soundmanager2"],function(e,t){return e.module("AskPatPlayerApp.Player",function(e,n,i,r,a){var s=[],o=[],l=[];e.Controller={init:function(e){var i=e.model.get("region"),r=e.model.get("options"),u=n.request("player:entity",e);l[i]=new t.Player({model:u});var p=0,c=n.request("track:entities",e);c.each(function(e){var t=e.get("data");p+="number"==typeof t.playback_count?t.playback_count:0}),l[i].on("resize",function(){var e=l[i].model.get("data");if(window.innerWidth>768){var t=l[i].$el.outerWidth();null===e.show_logo||void 0===e.show_logo||""===e.show_logo?t=t:t-=100,l[i].$(".spp-track").css({width:t+"px"}),l[i].$(".spp-show-logo").show()}else l[i].$(".spp-track").css({width:"100%"}),l[i].$(".spp-show-logo").hide()}),l[i].on("track:show-notes",function(){this.$el.parents(".smart-podcast-player").find(".spp-track-details-container").is(":visible")?(this.$el.parents(".smart-podcast-player").find(".spp-track-details-container").hide(),l[i].$(".spp-show-notes-button").text("Show Notes")):(this.$el.parents(".smart-podcast-player").find(".spp-track-details-container").show(),l[i].$(".spp-show-notes-button").text("Hide Notes"))}),l[i].on("show",function(){var e=l[i].model.get("data");if(window.innerWidth>768){var t=l[i].$el.outerWidth();null===e.show_logo||void 0===e.show_logo||""===e.show_logo?t=t:t-=100,l[i].$(".spp-track").css({width:t+"px"}),l[i].$(".spp-show-logo").show()}else l[i].$(".spp-track").css({width:"100%"}),l[i].$(".spp-show-logo").hide();if(p){var n=p.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" Listens";""!=e.show_name&&void 0!==e.show_name&&(n=" • "+n),l[i].$(".spp-show-count").text(n)}}),l[i].on("render",function(){var e=l[i].model.get("data");if(window.innerWidth>768){var t=l[i].$el.outerWidth();null===e.show_logo||void 0===e.show_logo||""===e.show_logo?t=t:t-=100,l[i].$(".spp-track").css({width:t+"px"}),l[i].$(".spp-show-logo").show()}else l[i].$(".spp-track").css({width:"100%"}),l[i].$(".spp-show-logo").hide();if(p){var n=p.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" Listens";""!=e.show_name&&void 0!==e.show_name&&(n=" • "+n),l[i].$(".spp-show-count").text(n)}}),l[i].on("track:play",function(t){var i=this.$el.hasClass("spp-playing"),r=(t.model.get("data"),"track_"+t.model.cid);a(".spp-track, .smart-track-player").removeClass("spp-playing"),i?(a(".spp-player").removeClass("spp-playing"),this.$(".spp-player-playlist .spp-track").removeClass("spp-active"),soundManager.pauseAll(),n.request("track:entities:set",e,"playing",!1)):(soundManager.pauseAll(),soundManager.play(r),this.$el.addClass("spp-playing"),n.request("track:entities:set",e,"playing",!1),n.request("track:entity:set",e,t.model,"playing",!0),a('.spp-track[data-tid="'+r+'"]').addClass("spp-playing"))}),l[i].on("track:speed",function(t){var i=this.$el.hasClass("spp-playing"),r=(t.model.get("data"),"track_"+t.model.cid),s=soundManager.getSoundById(r);a(".spp-track, .smart-track-player").removeClass("spp-playing"),i||(soundManager.pauseAll(),soundManager.play(r),this.$el.addClass("spp-playing"),n.request("track:entities:set",e,"playing",!1),n.request("track:entity:set",e,t.model,"playing",!0),a('.spp-track[data-tid="'+r+'"]').addClass("spp-playing")),s.isHTML5&&(.5==s._a.playbackRate?(this.$el.hasClass("spp-speeding-half")&&this.$el.removeClass("spp-speeding-half"),s._a.playbackRate=1):1==s._a.playbackRate?(this.$el.addClass("spp-speeding-onehalf"),s._a.playbackRate=1.5):1.5==s._a.playbackRate?(this.$el.hasClass("spp-speeding-onehalf")&&this.$el.removeClass("spp-speeding-onehalf"),this.$el.addClass("spp-speeding-two"),s._a.playbackRate=2):2==s._a.playbackRate?(this.$el.hasClass("spp-speeding-two")&&this.$el.removeClass("spp-speeding-two"),this.$el.addClass("spp-speeding-three"),s._a.playbackRate=3):3==s._a.playbackRate?(this.$el.hasClass("spp-speeding-three")&&this.$el.removeClass("spp-speeding-three"),this.$el.addClass("spp-speeding-half"),s._a.playbackRate=.5):s._a.playbackRate=1)}),l[i].on("track:seek",function(t){function r(){p.bytesLoaded/p.bytesTotal>m&&(p.setPosition(m*p.durationEstimate),p.play(),clearInterval(f))}if(window.innerWidth>768){var s=this.$el.hasClass("spp-playing"),o=l[i].model.get("data"),u="track_"+l[i].model.cid;s||(soundManager.pauseAll(),soundManager.play(u),this.$el.addClass("spp-playing"),n.request("track:entities:set",e,"playing",!1),n.request("track:entity:set",e,ItemView.model,"playing",!0),a('.spp-track[data-tid="'+u+'"]').addClass("spp-playing"));{var p=soundManager.getSoundById("track_"+l[i].model.cid),c=l[i].$(".spp-track").offset(),d=t.pageX-c.left,h=a(t.currentTarget).outerWidth();p.position,o.durationEstimate}void 0==d&&(d=t.pageX-this.$(".spp-track").offset().left);var f,m=d/h;p.bytesLoaded/p.bytesTotal>m?(p.pause(),p.setPosition(m*p.durationEstimate),p.play()):(this.$el.hasClass("spp-playing")||p.play(),p.pause(),f=setInterval(r,250))}}),l[i].on("cursor:move",function(e){if(window.innerWidth>768){l[i].$el.addClass("spp-hover");var t=l[i].$(".spp-track").offset(),n=e.pageX-t.left;this.$(".spp-position").css({left:n+"px"})}}),l[i].on("cursor:out",function(){if(window.innerWidth>768){var e=l[i].model.get("data"),t=soundManager.getSoundById("track_"+l[i].model.cid);if(t){var n=t.position,r=e.duration,a=n/r*100;l[i].$(".spp-position").css({left:a+"%"})}l[i].$el.removeClass("spp-hover")}}),l[i].on("track:next",function(t){var u=t.model,p=(u.get("data"),"track_"+u.cid);soundManager.pauseAll(),soundManager.unload(p),a(".spp-player").removeClass("spp-playing"),s[i]=n.request("track:entities:current",e),o[i]=n.request("track:entities:paged",e,s[i],r.current_page,r.tracks_per_page);var c=s[i].indexOf(u),d=c+1,h=s[i].length-1,f=s[i].at(h>d?d:0);n.trigger("playlist:paging:track",e,f),l[i].trigger("track:update",f)}),l[i].on("track:previous",function(t){var a=t.model,u=(a.get("data"),"track_"+a.cid);soundManager.pauseAll(),soundManager.unload(u),s[i]=n.request("track:entities:current",e),o[i]=n.request("track:entities:paged",e,s[i],r.current_page,r.tracks_per_page);var p=s[i].indexOf(a),c=p-1,d=s[i].length-1,h=s[i].at(0>c?d:c);n.trigger("playlist:paging:track",e,h),l[i].trigger("track:update",h)}),l[i].on("track:update",function(t){{var r=(t.get("data"),"track_"+t.cid),s=(l[i].model.get("data"),"track_"+l[i].model.cid);this.$el.hasClass("spp-playing")}a(".spp-player").removeClass("spp-playing"),a(".spp-track").removeClass("spp-active"),s==r?l[i].trigger("track:play",this):(a('.spp-track[data-tid="'+s+'"]').addClass("spp-active"),soundManager.pauseAll(),soundManager.unload(s),l[i].model=t,l[i].render(),l[i].trigger("track:play",this),n.trigger("playlist:paging:update",e),n.trigger("track-details:show",e,t))}),e.playerRegion.show(l[i])},playTrack:function(e,t){var n=e.model.get("region");l[n].trigger("track:update",t)}}}),e.AskPatPlayerApp.Player.Controller}),r("apps/smart-podcast-player/app",["app"],function(e){return e.module("AskPatPlayerApp",function(e,t){var n={initCore:function(e){i(["apps/smart-podcast-player/core/controller"],function(t){t.init(e)})},setupColors:function(e){i(["apps/smart-podcast-player/core/controller"],function(t){t.setupColors(e)})},initPlaylist:function(e){i(["apps/smart-podcast-player/playlist/controller"],function(t){t.init(e)})},updatePlaylistPaging:function(e){i(["apps/smart-podcast-player/playlist/controller"],function(t){t.updatePaging(e)})},gotoPlaylistTrackPage:function(e,t){i(["apps/smart-podcast-player/playlist/controller"],function(n){n.gotoPlaylistTrackPage(e,t)})},filterPlaylist:function(e,t){i(["apps/smart-podcast-player/playlist/controller"],function(n){n.filter(e,t)})},initTrackDetails:function(e){i(["apps/smart-podcast-player/track-details/controller"],function(t){t.init(e)})},showTrack:function(e,t){i(["apps/smart-podcast-player/track-details/controller"],function(n){n.show(e,t)})},initPlayer:function(e){i(["apps/smart-podcast-player/player/controller"],function(t){t.init(e)})},playTrack:function(e,t){i(["apps/smart-podcast-player/player/controller"],function(n){n.playTrack(e,t)})}};t.on("app:core:init",function(){n.initCore()}),t.on("core:color:setup",function(){n.setupColors()}),t.on("player:track:play",function(e,t){n.playTrack(e,t)}),t.on("player:init",function(e){n.initPlayer(e)}),t.on("playlist:paging:update",function(e){n.updatePlaylistPaging(e)}),t.on("playlist:paging:track",function(e,t){n.gotoPlaylistTrackPage(e,t)}),t.on("playlist:init",function(e){n.initPlaylist(e)}),t.on("playlist:filter",function(e,t){n.filterPlaylist(e,t)}),t.on("track-details:init",function(e){n.initTrackDetails(e)}),t.on("track-details:show",function(e,t){n.showTrack(e,t)})}),e.PlaylistApp}),r("app",["jquery","marionette","soundmanager2"],function(e,t){var n=new t.Application;return n.options={},n.options.current_page=1,n.options.tracks_per_page=10,n.on("initialize:after",function(){(jQuery(".smart-podcast-player").length>0||jQuery(".smart-track-player").length>0)&&i(["apps/smart-podcast-player/app"],function(){soundManager.setup({flashVersion:9,useHighPerformance:!0,wmode:"transparent",useHTML5Audio:!0,preferFlash:!1,onready:function(){n.trigger("app:core:init")}})})}),n}),r("text!templates/track-template.html",[],function(){return'<% if ( data.show_logo != undefined && data.show_logo != null ) { %>\r\n	<div class="spp-show-logo">\r\n		<img src="<%= data.show_logo %>" alt="<%= data.show_name %>" />\r\n	</div>\r\n<% } %>\r\n\r\n<div class="spp-track">\r\n	<% if ( data.artist != undefined && data.artist != null ) { %>\r\n	<p class="spp-artist"><%= data.artist %></p>\r\n	<% } %>		\r\n\r\n	<h3 class="spp-track-title"><%= data.title %></h3>\r\n	<p class="spp-duration"></p>\r\n	\r\n	<div class="spp-progress">\r\n		<div class="spp-current-time"></div>\r\n		<div class="spp-position"></div>\r\n		<div class="spp-total-time"></div>\r\n	</div>\r\n\r\n	<div class="spp-loaded-container">\r\n		<div class="spp-loaded"></div>\r\n	</div>\r\n\r\n	<div class="spp-controls">\r\n		<% if ( data.paid == true ) { %>\r\n			<% if ( data.speedcontrol == true ) { %>\r\n				<span class="spp-speed"></span>\r\n			<% } %>\r\n			 <% if ( data.social == true ) { %>\r\n				<span class="spp-share">\r\n					<div class="spp-share-options">\r\n						<% if ( data.social_twitter == true ) { %>\r\n							<a href="" class="spp-share-icon spp-twitter-btn">Share</a>\r\n						<% } %>\r\n						<% if ( data.social_facebook == true ) { %>\r\n							<a href="" class="spp-share-icon spp-fb-btn">Share</a>\r\n						<% } %>\r\n						<% if ( data.social_gplus == true ) { %>\r\n							<a href="" class="spp-share-icon spp-gplus-btn">Share</a>\r\n						<% } %>\r\n						<% if ( data.social_linkedin == true ) { %>\r\n							<a href="" class="spp-share-icon spp-linkedin-btn">Share</a>\r\n						<% } %>\r\n						<% if ( data.social_stumble == true ) { %>\r\n							<a href="" class="spp-share-icon spp-stumble-btn">Share</a>\r\n						<% } %>\r\n						<% if ( data.social_pinterest == true ) { %>\r\n							<a href="" class="spp-share-icon spp-pinterest-btn">Share</a>\r\n						<% } %>\r\n						<% if ( data.social_email == true ) { %>\r\n							<a href="" class="spp-share-icon spp-email-btn">Share</a>\r\n						<% } %>\r\n					</div>\r\n				</span>\r\n			<% } %>\r\n		<% } %>\r\n\r\n	   <% var adl = document.createElement(\'a\'); %>\r\n	   <% var adloff = /Firefox/i.test(navigator.userAgent); %>\r\n\r\n	   <% if ( data.download == true && (typeof adl.download != "undefined")  && (!adloff) && data.method != \'soundcloud\' ) { %><a href="<%= data.url %>" download="<%= data.filename %>"><span class="spp-dloada"></span></a><% } %>\r\n	   <% if ( data.download == true && (typeof adl.download == "undefined" || (adloff) || data.method == \'soundcloud\' ) ) { %><span class="spp-dload"></span><% } %>\r\n		<span class="spp-play"></span>\r\n	</div>\r\n\r\n	<iframe class="spp-downloader" style="display:none"></iframe>\r\n	\r\n</div>\r\n\r\n<%if ( data.paid != true ) { %>\r\n	<div class="spp-logo"></div>\r\n<% } %>\r\n'}),r("apps/smart-track-player/player/view",["app","text!templates/track-template.html"],function(e,n){return e.module("SmartTrackPlayerApp.Player.View",function(e,i,r,a,s,o){e.Player=a.ItemView.extend({template:o.template(n),className:"smart-track-player",events:{"mousemove .spp-track":"cursorMove","mouseout .spp-track":"cursorOut","click .spp-position":"seek","click .spp-play":"play","click .spp-button-download":"download","click .spp-dload":"download","click .spp-speed":"speed","hover .spp-play":"shareOut","hover .spp-button-download":"shareOut","hover .spp-dload":"shareOut","hover .spp-dloada":"shareOut","hover .spp-speed":"shareOut","hover .spp-share":"shareOn","hover .spp-share-options":"shareOn","click .spp-share":"shareOn","click .spp-share-icon":"share","mouseleave .spp-controls":"shareOut"},initialize:function(){this.hover=!1;var e=this;s(window).on("resize",function(){e.resize()})},download:function(e){e.preventDefault();var t=this.model.get("data"),n=t.download_url,i=t.download_id;"https:"===location.protocol&&(n=n.replace(/^http:\/\//i,"https://"));var r=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(r||"soundcloud"==t.method&&"http:"!==location.protocol){if("soundcloud"==t.method)var a=n+"?consumer_key="+AP_Player.soundcloudConsumerKey;else var a=n;window.location=a}else{if("soundcloud"==t.method)var a=n+"?consumer_key="+AP_Player.soundcloudConsumerKey;else var a=AP_Player.homeUrl+"/?spp_download="+i;this.$(".spp-downloader").prop("src",a)}},resize:function(){var e=this.model.get("data");if(window.innerWidth>768){var t=s(".smart-track-player").first().outerWidth();null===e.artwork_url||void 0===e.artwork_url||(t-=100),this.$(".spp-track").css({width:t+"px"})}else this.$(".spp-track").css({width:"100%"})},socialPopup:function(e,t){window.open(t,"pinterest","screenX=100,screenY=100,height=360,width=730"),e.preventDefault(),e.stopPropagation()},shareOn:function(){this.$(".spp-share-options").css("display","block")},shareOut:function(){this.$(".spp-share-options").css("display","none")},share:function(e){var t=this,n=t.model.get("data"),i=s(e.currentTarget),r=window.location.href;if((i.hasClass("spp-facebook")||i.hasClass("spp-fb-btn"))&&this.socialPopup(e,"http://www.facebook.com/sharer/sharer.php?m2w&s=100&p[url]="+encodeURIComponent(r)+"&p[images][0]=&p[title]="+encodeURIComponent(n.title)),i.hasClass("spp-twitter")||i.hasClass("spp-twitter-btn")){var a="url="+encodeURIComponent(r)+"&text="+encodeURIComponent(n.title);""!=n.hashtag&&void 0!=n.hashtag&&(a=a+" "+encodeURIComponent("#"+n.hashtag)),this.socialPopup(e,"https://twitter.com/intent/tweet?"+a)}(i.hasClass("spp-gplus")||i.hasClass("spp-gplus-btn"))&&this.socialPopup(e,"https://plus.google.com/share?url="+encodeURIComponent(r)),(i.hasClass("spp-stumble")||i.hasClass("spp-stumble-btn"))&&this.socialPopup(e,"http://www.stumbleupon.com/submit?url="+encodeURIComponent(r)+"&title="+encodeURIComponent(n.title)),(i.hasClass("spp-pinterest")||i.hasClass("spp-pinterest-btn"))&&this.socialPopup(e,"https://pinterest.com/pin/create/button/?url="+encodeURIComponent(r)),(i.hasClass("spp-linkedin")||i.hasClass("spp-linkedin-btn"))&&this.socialPopup(e,"https://www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(r)+"&title="+encodeURIComponent(n.title))},stop:function(){this.$el.removeClass("spp-playing")},seek:function(e){function t(){r.bytesLoaded/r.bytesTotal>d&&(p=null!==r.duration?r.duration:r.durationEstimate,a.pause(),r.setPosition(d*p),a.play(),clearInterval(c))}if(s(window).outerWidth()>768){var n=this.model.get("data"),i="smart_track_"+n.track_uid+"_"+this.model.cid,r=soundManager.getSoundById(i),a=this;void 0===r&&(r=this.createSound(),r.load());var o=this.$(".spp-track").offset(),l=e.pageX-o.left,u=this.$(".spp-track").outerWidth(),p=null!==r.duration?r.duration:r.durationEstimate;void 0==l&&(l=e.pageX-this.$(".spp-track").offset().left);var c,d=l/u;r.bytesLoaded/r.bytesTotal>d&&null!==p?(p=null!==r.duration?r.duration:r.durationEstimate,this.$el.hasClass("spp-playing")&&this.pause(),r.setPosition(d*p),this.play()):(this.pause(),c=setInterval(t,250))}},cursorMove:function(e){if(this.trigger("cursor:move",e),window.innerWidth>768){this.hover=!0;var t=this.$(".spp-track").offset(),n=e.pageX-t.left;this.$(".spp-position").css({left:n+"px"})}},cursorOut:function(){if(window.innerWidth>768){var e=this.model.get("data"),t="smart_track_"+e.track_uid+"_"+this.model.cid,n=soundManager.getSoundById(t);if(n){var i=n.position,r=n.duration,a=i/r*100;this.$(".spp-position").css({left:a+"%"})}this.hover=!1}},onRender:function(){{var e=this.model.get("data");"smart_track_"+e.track_uid+"_"+this.model.cid}if(window.innerWidth>768){var t=s(".smart-track-player").first().outerWidth();null===e.show_logo||void 0===e.show_logo||(t-=60),this.$(".spp-track").css({width:t+"px"})}else this.$(".spp-track").css({width:"100%"}),this.$(".spp-show-logo").hide();void 0!==e.download&&this.$el.addClass("spp-has-download"),void 0!==e.color&&this.$el.addClass("stp-color-"+e.color),void 0!==e.get&&0!=e.get&&"file"==e.method&&this.fetchTrackData(e.url)},fetchTrackData:function(e){var t=this,n={action:"fetch_track_data",url:e};console.log("Getting track data"),s.post(AP_Player.ajaxurl,n,function(e){var n=t.model.get("data");e=JSON.parse(e),"0"!=e?(void 0===typeof e.title||void 0!=n.title&&'Getting file data<span class="spp-loading-ellipsis">...</span>'!=n.title||(n.title=e.title),void 0!==typeof e.artist&&void 0==n.artist&&(n.artist=e.artist),n.get=!1,t.model.set({data:n}),void 0!==typeof e.title&&t.$(".spp-track-title").text(n.title),void 0!==typeof e.artist&&(t.$(".spp-artist").length>0?t.$(".spp-artist").text(n.artist):t.$(".spp-track-title").before('<p class="spp-artist">'+n.artist+"</p>")),void 0!=t.loading_timer&&clearInterval(t.loading_timer),t.render()):(n.title="Unable to retrieve track data",n.get=!1,t.model.set({data:n}),t.render())})},pause:function(){var e=this.model.get("data"),t="smart_track_"+e.track_uid+"_"+this.model.cid,n=soundManager.getSoundById(t);n.pause(),this.$el.removeClass("spp-playing")},speed:function(){var e=this.model.get("data"),t="smart_track_"+e.track_uid+"_"+this.model.cid,n=soundManager.getSoundById(t);if(void 0===n)n=this.createSound(),this.play();else{var i=this.$el.hasClass("spp-playing");i||this.play()}n.isHTML5&&(.5==n._a.playbackRate?(this.$el.hasClass("spp-speeding-half")&&this.$el.removeClass("spp-speeding-half"),n._a.playbackRate=1):1==n._a.playbackRate?(this.$el.addClass("spp-speeding-onehalf"),n._a.playbackRate=1.5):1.5==n._a.playbackRate?(this.$el.hasClass("spp-speeding-onehalf")&&this.$el.removeClass("spp-speeding-onehalf"),this.$el.addClass("spp-speeding-two"),n._a.playbackRate=2):2==n._a.playbackRate?(this.$el.hasClass("spp-speeding-two")&&this.$el.removeClass("spp-speeding-two"),this.$el.addClass("spp-speeding-three"),n._a.playbackRate=3):3==n._a.playbackRate?(this.$el.hasClass("spp-speeding-three")&&this.$el.removeClass("spp-speeding-three"),this.$el.addClass("spp-speeding-half"),n._a.playbackRate=.5):n._a.playbackRate=1)
},play:function(){var e=this.$el.hasClass("spp-playing"),t=this.model.get("data"),n="smart_track_"+t.track_uid+"_"+this.model.cid,i=soundManager.getSoundById(n);void 0===i&&(i=this.createSound()),s(".spp-track").removeClass("spp-playing"),e?(this.$el.removeClass("spp-playing"),soundManager.pauseAll()):(soundManager.pauseAll(),i.play(),this.$el.addClass("spp-playing"))},createSound:function(){var e=this,n=this.model,i=n.get("data"),r="smart_track_"+i.track_uid+"_"+this.model.cid,a=soundManager.createSound({id:r,url:i.url,type:"audio/mp3",onload:function(){},onresume:function(){},onplay:function(){},onid3:function(){},onfinish:function(){e.stop()},whileloading:function(){var t=this.bytesLoaded/this.bytesTotal*100+"%";e.$(".spp-loaded").width(t),this.bytesLoaded/this.bytesTotal==1&&e.$(".spp-loaded-container").fadeOut("slow")},whileplaying:function(){var n,i,r,a,s=this.durationEstimate,o=this.position,l=s-o;n=o/1e3,i=n/60,r=i/60,a=Math.floor(r)+":"+t(Math.floor(i%60),2)+":"+t(Math.floor(n%60),2),n=l/1e3,i=n/60,r=i/60,remaining_time=t(Math.floor(i),2)+":"+t(Math.floor(n%60),2),e.$(".spp-duration").text("-"+remaining_time);var u=o/s*100;e.$(".spp-current-time").css({width:u+"%"}),e.hover===!1&&e.$(".spp-position").css({left:u+"%"})}});return a}})}),e.SmartTrackPlayerApp.Player.View}),r("entities/player-track",["app"],function(e){e.module("Entities",function(e,t,n){e.Player=n.Model.extend({defaults:{data:{}}}),e.Track=n.Model.extend({defaults:{data:{active:!1,artwork_url:"",attachments_uri:"",bpm:null,comment_count:0,commentable:!0,created_at:"",current_time:"0:00:00",description:"",download_count:0,download_url:"",downloadable:!0,duration:0,duration_time:"0:00:00",episode_number:0,embeddable_by:"all",favoritings_count:0,filename:"",genre:"",id:0,isrc:"",key_signature:"",kind:"track",label_id:null,label_name:"",license:"",original_content_size:0,original_format:"mp3",permalink:"",permalink_url:"",playing:!1,playback_count:0,purchase_title:null,purchase_url:null,release:"",release_day:null,release_month:null,release_year:null,sharing:"",show_name:"",state:"",stream_url:"",streamable:!0,tag_list:"",tags:"",tag_string:"",title:"",track_type:"",uri:"",user:{avatar_url:"",id:0,kind:"user",permalink:"",permalink_url:"",uri:"",username:""},user_id:0,video_url:null,waveform_url:"",show_notes:""}}})})}),r("entities/player",["app","entities/player-track"],function(e){return e.module("Entities",function(e,t){var n=[],i=function(e){var i=e.model.get("region");n[i]=t.request("track:entity:current",e)},r={getPlayerEntities:function(e){var t=e.model.get("region");return void 0===n[t]&&i(e),n[t]}};t.reqres.setHandler("player:entity",function(e){return r.getPlayerEntities(e)})}),e.Entities}),r("apps/smart-track-player/player/controller",["app-player","apps/smart-track-player/player/view","entities/player","entities/player-track","soundmanager2"],function(e,t){return e.module("SmartTrackPlayerApp.Player",function(e,n,i,r,a){e.Controller={init:function(){a(".smart-track-player").length>0&&n.trigger("core:color:setup"),a(".smart-track-player").each(function(e,n){var r=a(n).data("url"),s={url:r,track_uid:a(n).data("uid"),show_logo:a(n).data("image"),download:a(n).data("download"),download_url:r,color:a(n).data("color"),title:a(n).data("title"),artist:a(n).data("artist"),filename:"",social:a(n).data("social"),social_twitter:a(n).data("social_twitter"),social_facebook:a(n).data("social_facebook"),social_gplus:a(n).data("social_gplus"),social_linkedin:a(n).data("social_linkedin"),social_stumble:a(n).data("social_stumble"),social_pinterest:a(n).data("social_pinterest"),social_email:a(n).data("social_email"),speedcontrol:a(n).data("speedcontrol"),paid:a(n).data("paid"),get:a(n).data("get"),method:"file",download_id:a(n).data("download_id")},o=document.createElement("a");o.href=r;var l=o.hostname;if(l.indexOf("soundcloud.com")>-1){var u="",p={action:"get_soundcloud_track",stream:r};a.ajax({url:AP_Player.ajaxurl,dataType:"json",async:!1,type:"POST",data:p,success:function(e){u=e}}),s.method="soundcloud",s.url=u.stream_url+"?consumer_key="+AP_Player.soundcloudConsumerKey,s.title=s.title?s.title:u.title,s.download_url=u.download_url,s.filename=u.permalink+".mp3";var c=new i.Model({data:s}),d=new t.Player({model:c});d.render(),a(n).after(d.$el);var h="?spp_view=1";h+="&type=track",h+="&url="+s.url,h+="&download="+(void 0!=s.download?encodeURIComponent(s.download):""),h+="&title="+(void 0!=s.title?encodeURIComponent(s.title):""),h+="&artist="+(void 0!=s.artist?encodeURIComponent(s.artist):""),h+="&image="+(void 0!=s.image?encodeURIComponent(s.image):""),h+="&color="+(void 0!=s.color?encodeURIComponent(s.color):""),a(n).remove()}else{void 0!=s.get&&void 0==s.title&&(s.title='Getting file data<span class="spp-loading-ellipsis">...</span>'),s.filename=s.url.replace(/^.*[\\\/]/,"");var c=new i.Model({data:s}),d=new t.Player({model:c});d.on("render",function(){if(this.$(".spp-loading-ellipsis").length>0){var e=this,t=0;this.loading_timer=setInterval(function(){t++;var n=new Array(t%5).join(".");e.$(".spp-loading-ellipsis").text("."+n)},300)}}),d.render(),a(n).after(d.$el);var h="?spp_view=1";h+="&type=track",h+="&url="+s.url,h+="&download="+(void 0!=s.download?encodeURIComponent(s.download):""),h+="&image="+(void 0!=s.image?encodeURIComponent(s.image):""),h+="&color="+(void 0!=s.color?encodeURIComponent(s.color):""),a(n).remove()}})},setupColors:function(){var e=new Array;a(".smart-track-player").each(function(t,n){var i=a(n).attr("class"),r=i.trim().split(/\s+/);a.each(r,function(t,n){var i=n.indexOf("stp-color-");if(i>-1){var r=n.replace("stp-color-","");"60b86c"!=r&&-1==a.inArray(r,e)&&e.push(r)}})});var t={action:"get_colors",stp_colors:e};e.length>=1&&a.post(AP_Player.ajaxurl,t,function(e){a("head").append(e)})}}}),e.SmartTrackPlayerApp.Player.Controller}),r("apps/smart-track-player/app",["app-player"],function(e){return e.module("SmartTrackPlayerApp",function(e,t){var n={initPlayer:function(){i(["apps/smart-track-player/player/controller"],function(e){e.init()})},setupColors:function(e){i(["apps/smart-track-player/player/controller"],function(t){t.setupColors(e)})}};t.on("player:init",function(){n.initPlayer()}),t.on("core:color:setup",function(){n.setupColors()})}),e.SmartTrackPlayerApp}),r("app-player",["marionette","soundmanager2"],function(e){var t=new e.Application;return t.options={},t.on("initialize:after",function(){jQuery(".smart-track-player").length>0&&i(["apps/smart-track-player/app"],function(){soundManager.setup({flashVersion:9,wmode:"transparent",useHTML5Audio:!0,preferFlash:!1,onready:function(){t.trigger("player:init")}})})}),t}),"function"==typeof jQuery&&r("jquery",function(){return jQuery}),"function"==typeof _&&r("underscore",function(){return _}),i.config({name:"AP_Player_App",baseUrl:"/wp-content/plugins/smart-podcast-player/assets/js/",urlArgs:"bust="+(new Date).getTime(),paths:{backbone:"vendor/amdjs/backbone","backbone.wreqr":"vendor/amdjs/backbone.wreqr","backbone.babysitter":"vendor/amdjs/backbone.babysitter",marionette:"vendor/amdjs/marionette",soundmanager2:"vendor/soundmanager2-nodebug-jsmin","mwheel-intent":"vendor/mwheelIntent"},shim:{soundmanager2:{exports:"soundManager"},"vendor/jquery.mousewheel":["jquery","mwheel-intent"],"vendor/jquery.jscrollpane.min":["jquery","vendor/jquery.mousewheel","mwheel-intent"]}}),i(["jquery","app"],function(e,t){var n=jQuery(window).width(),i=jQuery(window).height();jQuery(window).on("resize",function(){(n!=jQuery(window).width()||i!=jQuery(window).height())&&(n=jQuery(window).width(),i=jQuery(window).height(),jQuery(window).trigger("spp_resize"))}),e(window).resize(function(){e(".smart-podcast-player").each(function(){var t=e(this).parent(),n=e(t).width(),i=e(window).width();768>n||768>i?t.addClass("spp-player-small"):t.removeClass("spp-player-small")})}),e(".smart-podcast-player").each(function(){var t=e(this).parent(),n=e(t).width(),i=e(window).width();(768>n||768>i)&&t.addClass("spp-player-small")}),t.start()}),i(["jquery","app-player"],function(e,t){jQuery(".smart-track-player ").length>0&&t.start()}),r("main",function(){})}();